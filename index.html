<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Topics API</title>
  <meta content="w3c/CG-DRAFT" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <meta content="Bikeshed version d9bd89757, updated Thu Mar 23 10:06:53 2023 -0700" name="generator">
  <link href="https://github.com/patcg-individual-drafts/topics" rel="canonical">
  <meta content="8fb298ffa16f8ebe1882502a5cfb978683d0dcd6" name="document-revision">
<style>
/* .XXX from https://resources.whatwg.org/standard.css */
.XXX {
  color: #D50606;
  background: white;
  border: solid #D50606;
}
</style>
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    min-width: min-content;
    max-width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Topics API</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2023-03-30">30 March 2023</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://github.com/patcg-individual-drafts/topics">https://github.com/patcg-individual-drafts/topics</a>
      <dt>Issue Tracking:
      <dd><a href="https://github.com/patcg-individual-drafts/topics/issues/">GitHub</a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:yaoxia@chromium.org">Yao Xiao</a> (<span class="p-org org">Google</span>)
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jkarlin@chromium.org">Josh Karlin</a> (<span class="p-org org">Google</span>)
      <dt>Participate:
      <dd><a href="https://github.com/patcg-individual-drafts/topics">GitHub patcg-individual-drafts/topics</a> (<a href="https://github.com/patcg-individual-drafts/topics/issues/new">new issue</a>, <a href="https://github.com/patcg-individual-drafts/topics/issues?state=open">open issues</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2023 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification describes a method that could enable ad-targeting based on a person’s general browsing interests without exposing their exact browsing history.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction-header"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#terminology-and-types-header"><span class="secno">2</span> <span class="content">Terminology and types</span></a>
    <li><a href="#user-agent-associated-state-header"><span class="secno">3</span> <span class="content">User agent associated state</span></a>
    <li><a href="#browsing-topic-dictionary-header"><span class="secno">4</span> <span class="content">BrowsingTopic dictionary</span></a>
    <li><a href="#document-id-header"><span class="secno">5</span> <span class="content">document ID</span></a>
    <li><a href="#determine-topics-calculation-input-data-header"><span class="secno">6</span> <span class="content">Determine topics calculation input data</span></a>
    <li><a href="#collect-page-topics-calculation-input-data-header"><span class="secno">7</span> <span class="content">Collect page topics calculation input data</span></a>
    <li><a href="#collect-topics-caller-origin-header"><span class="secno">8</span> <span class="content">Collect topics caller origin</span></a>
    <li><a href="#periodically-calculate-user-topics-header"><span class="secno">9</span> <span class="content">Periodically calculate user topics</span></a>
    <li><a href="#epochs-for-caller-header"><span class="secno">10</span> <span class="content">Epochs for caller</span></a>
    <li><a href="#topics-for-caller-header"><span class="secno">11</span> <span class="content">Topics for caller</span></a>
    <li><a href="#the-javascript-api-header"><span class="secno">12</span> <span class="content">The JavaScript API</span></a>
    <li>
     <a href="#handle-topics-fetch-request-header"><span class="secno">13</span> <span class="content">Handle fetch(&lt;url>, {browsingTopics: true}) and &lt;iframe src=url browsingtopics>&lt;/></span></a>
     <ol class="toc">
      <li><a href="#send-browsing-topics-header-boolean-associated-with-request-header"><span class="secno">13.1</span> <span class="content">send browsing topics header boolean associated with Request</span></a>
      <li><a href="#browsing-topics-content-attribute-for-iframe-element-header"><span class="secno">13.2</span> <span class="content">browsingtopics content attribute for HTMLIframeElement</span></a>
      <li><a href="#browsing-topics-attribute-in-request-init-header"><span class="secno">13.3</span> <span class="content">browsingTopics attribute in RequestInit</span></a>
      <li><a href="#modification-to-request-constructor-steps-header"><span class="secno">13.4</span> <span class="content">Modification to request constructor steps</span></a>
      <li><a href="#modification-to-create-navigation-params-by-fetching-steps-header"><span class="secno">13.5</span> <span class="content">Modification to "create navigation params by fetching" steps</span></a>
      <li><a href="#the-sec-browsing-topics-http-request-header-header"><span class="secno">13.6</span> <span class="content">The `<code>Sec-Browsing-Topics</code>` HTTP request header</span></a>
      <li><a href="#modification-to-http-network-or-cache-fetch-algorithm-header"><span class="secno">13.7</span> <span class="content">Modification to HTTP-network-or-cache fetch algorithm</span></a>
      <li><a href="#append-or-modify-a-request-sec-browsing-topics-header-header"><span class="secno">13.8</span> <span class="content">Append or modify a request <code>Sec-Browsing-Topics</code> header</span></a>
      <li><a href="#the-observe-browsing-topics-http-response-header-header"><span class="secno">13.9</span> <span class="content">The `<code>Observe-Browsing-Topics</code>` HTTP response header</span></a>
      <li><a href="#modification-to-http-fetch-steps-header"><span class="secno">13.10</span> <span class="content">Modification to HTTP fetch steps</span></a>
     </ol>
    <li><a href="#permissions-policy-integration-header"><span class="secno">14</span> <span class="content">Permissions policy integration</span></a>
    <li><a href="#privacy-considerations-header"><span class="secno">15</span> <span class="content">Privacy considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="introduction-header"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction-header"></a></h2>
    <p>In today’s web, people’s interests are typically inferred based on observing what sites or pages they visit, which relies on tracking techniques like third-party cookies or less-transparent mechanisms like device fingerprinting. It would be better for privacy if interest-based advertising could be accomplished without needing to collect a particular individual’s browsing history.</p>
    <p>This specification provides an API to enable ad-targeting based on a person’s general browsing interests, without exposing their exact browsing history.</p>
    <div class="example" id="example-e14d82fa">
     <a class="self-link" href="#example-e14d82fa"></a> Creating an ad based on browsing interests, using the <code class="idl"><a data-link-type="idl" href="#dom-document-browsingtopics" id="ref-for-dom-document-browsingtopics">document.browsingTopics()</a></code> JavaScript API: 
     <p>(Inside an <code>https://ads.example</code> iframe)</p>
<pre class="lang-js highlight"><c- c1>// document.browsingTopics() returns an array of BrowsingTopic objects.</c->
<c- a>const</c-> topics <c- o>=</c-> <c- k>await</c-> document<c- p>.</c->browsingTopics<c- p>();</c->

<c- c1>// Get data for an ad creative.</c->
<c- a>const</c-> response <c- o>=</c-> <c- k>await</c-> fetch<c- p>(</c-><c- t>'https://ads.example/get-creative'</c-><c- p>,</c-> <c- p>{</c->
  method<c- o>:</c-> <c- t>'POST'</c-><c- p>,</c->
  headers<c- o>:</c-> <c- p>{</c->
    <c- t>'Content-Type'</c-><c- o>:</c-> <c- t>'application/json'</c-><c- p>,</c->
  <c- p>},</c->
  body<c- o>:</c-> JSON<c- p>.</c->stringify<c- p>(</c->topics<c- p>)</c->
<c- p>});</c->

<c- c1>// Get the JSON from the response.</c->
<c- a>const</c-> creative <c- o>=</c-> <c- k>await</c-> response<c- p>.</c->json<c- p>();</c->

<c- c1>// Display the ad.</c->
</pre>
    </div>
    <div class="example" id="example-a1020426">
     <a class="self-link" href="#example-a1020426"></a> Creating an ad based on browsing interests, based on the <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-browsing-topics" id="ref-for-http-headerdef-sec-browsing-topics">Sec-Browsing-Topics</a></code>`</span> HTTP request header sent by this invocation of <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-global-fetch" id="ref-for-dom-global-fetch">fetch()</a></code>: 
     <p>(Inside the top level context)</p>
<pre class="lang-js highlight"><c- c1>// A 'Sec-Browsing-Topics: [topics header value]' header will be sent in</c->
<c- c1>// the HTTP request.</c->
<c- a>const</c-> response <c- o>=</c-> <c- k>await</c-> fetch<c- p>(</c-><c- t>'https://ads.example/get-creative'</c-><c- p>,</c-> <c- p>{</c->browsingTopics<c- o>:</c-> <c- kc>true</c-><c- p>});</c->
<c- a>const</c-> ad_creative <c- o>=</c-> <c- k>await</c-> response<c- p>.</c->json<c- p>();</c->
<c- c1>// Display the ad.</c->
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="terminology-and-types-header"><span class="secno">2. </span><span class="content">Terminology and types</span><a class="self-link" href="#terminology-and-types-header"></a></h2>
     A <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-taxonomy">taxonomy</dfn> comprises a list of advertising <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-topic-ids">topic ids</dfn> as integers. A <a data-link-type="dfn" href="#browsing-topics-types-taxonomy" id="ref-for-browsing-topics-types-taxonomy">taxonomy</a> is identified by a <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-taxonomy-version">taxonomy version</dfn> string. A <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids">topic id</a> is no smaller than 1. 
    <p>The taxonomy must be in a tree hierarchy, where an ancestor <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids①">topic id</a> always represents something more general than its descendant <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids②">topic ids</a>. The browser should implement an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-descendant-topics">get descendant topics</dfn> algorithm, which takes in a <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids③">topic id</a>, and returns its descendants <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids④">topic ids</a> as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a>.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-model-version">model version</dfn> is a string that identifies the <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-model">model</dfn> used to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="classify">classify</dfn> a string into <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids⑤">topic ids</a>. The meaning may vary across browser vendors. The classification result <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids⑥">topic ids</a> should be relevant to the input string’s underlying content.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-configuration-version">configuration version</dfn> identifies the algorithm (other than the model part) used to calculate the topic. It should take the form of "<code>&lt;browser vendor identifier>.&lt;an integer version></code>". The meaning may vary across browser vendors.</p>
    <p>Given <a data-link-type="dfn" href="#browsing-topics-types-configuration-version" id="ref-for-browsing-topics-types-configuration-version">configuration version</a> <var>configurationVersion</var>, <a data-link-type="dfn" href="#browsing-topics-types-taxonomy-version" id="ref-for-browsing-topics-types-taxonomy-version">taxonomy version</a> <var>taxonomyVersion</var>, and <a data-link-type="dfn" href="#browsing-topics-types-model-version" id="ref-for-browsing-topics-types-model-version">model version</a> <var>modelVersion</var>, the <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-version">version</dfn> is the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-concatenate" id="ref-for-string-concatenate">concatenating</a> « <var>configurationVersion</var>, <var>taxonomyVersion</var>, <var>modelVersion</var> » using "<code>:</code>".</p>
    <p>A <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-user-topics-state">user topics state</dfn> is a struct with the following fields and default values:</p>
    <ul>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="user topics state" data-dfn-type="dfn" data-noexport id="user-topics-state-epochs">epochs</dfn>: a list of <a data-link-type="dfn" href="#browsing-topics-types-epoch" id="ref-for-browsing-topics-types-epoch">epoch</a>s, default to an empty list.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="user topics state" data-dfn-type="dfn" data-noexport id="user-topics-state-hmac-key">hmac key</dfn>: 128 bit number, default to 0.</p>
    </ul>
    <p>An <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-epoch">epoch</dfn> is a struct with the following fields:</p>
    <ul>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="epoch" data-dfn-type="dfn" data-noexport id="epoch-taxonomy">taxonomy</dfn>: a list of integers.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="epoch" data-dfn-type="dfn" data-noexport id="epoch-taxonomy-version">taxonomy version</dfn>: a string.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="epoch" data-dfn-type="dfn" data-noexport id="epoch-model-version">model version</dfn>: a string.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="epoch" data-dfn-type="dfn" data-noexport id="epoch-config-version">config version</dfn>: a string.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="epoch" data-dfn-type="dfn" data-noexport id="epoch-top-5-topics-with-caller-origins">top 5 topics with caller origins</dfn>: a list of <a data-link-type="dfn" href="#browsing-topics-types-topic-with-caller-origins" id="ref-for-browsing-topics-types-topic-with-caller-origins">topic with caller origins</a>.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="epoch" data-dfn-type="dfn" data-noexport id="epoch-time">time</dfn>: a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp">DOMHighResTimeStamp</a></code> (from Unix epoch).</p>
    </ul>
    <p>A <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-topic-with-caller-origins">topic with caller origins</dfn> is a struct with the following fields:</p>
    <ul>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topic with caller origins" data-dfn-type="dfn" data-noexport id="topic-with-caller-origins-topic-id">topic id</dfn>: an integer.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topic with caller origins" data-dfn-type="dfn" data-noexport id="topic-with-caller-origins-caller-origins">caller origins</dfn>: a set of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origins</a>.</p>
    </ul>
    <p>A <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-topics-history-entry">topics history entry</dfn> is a struct with the following fields and default values:</p>
    <ul>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics history entry" data-dfn-type="dfn" data-noexport id="topics-history-entry-document-id">document id</dfn>: an integer, default to 0.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics history entry" data-dfn-type="dfn" data-noexport id="topics-history-entry-topics-calculation-input-data">topics calculation input data</dfn>: a string, default to an empty string.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics history entry" data-dfn-type="dfn" data-noexport id="topics-history-entry-time">time</dfn>: a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp①">DOMHighResTimeStamp</a></code> (from Unix epoch).</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics history entry" data-dfn-type="dfn" data-noexport id="topics-history-entry-topics-caller-origins">topics caller origins</dfn>: an ordered set of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origins</a>, default to an empty set.</p>
    </ul>
    <p>A <dfn class="dfn-paneled" data-dfn-for="browsing topics types" data-dfn-type="dfn" data-noexport id="browsing-topics-types-topics-caller-context">topics caller context</dfn> is a struct with the following fields:</p>
    <ul>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics caller context" data-dfn-type="dfn" data-noexport id="topics-caller-context-caller-origin">caller origin</dfn>: an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin②">origin</a>.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics caller context" data-dfn-type="dfn" data-noexport id="topics-caller-context-top-level-context-domain">top level context domain</dfn>: a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-domain" id="ref-for-concept-domain">domain</a>.</p>
     <li data-md>
      <p><dfn class="dfn-paneled" data-dfn-for="topics caller context" data-dfn-type="dfn" data-noexport id="topics-caller-context-timestamp">timestamp</dfn>: a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp" id="ref-for-dom-domhighrestimestamp②">DOMHighResTimeStamp</a></code> (from Unix epoch).</p>
    </ul>
    <h2 class="heading settled" data-level="3" id="user-agent-associated-state-header"><span class="secno">3. </span><span class="content">User agent associated state</span><a class="self-link" href="#user-agent-associated-state-header"></a></h2>
     Each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent">user agent</a> has an associated <a data-link-type="dfn" href="#browsing-topics-types-user-topics-state" id="ref-for-browsing-topics-types-user-topics-state">user topics state</a> <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-user-topics-state">user topics state</dfn> with <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs">epochs</a> initially empty, and <a data-link-type="dfn" href="#user-topics-state-hmac-key" id="ref-for-user-topics-state-hmac-key">hmac key</a> initially a randomly generated 128 bit number. 
    <p>Each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent①">user agent</a> has an associated <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-topics-history-storage">topics history storage</dfn> to store the information about the visited pages that are needed for topics calculation. It is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> of <a data-link-type="dfn" href="#browsing-topics-types-topics-history-entry" id="ref-for-browsing-topics-types-topics-history-entry">topics history entries</a>, initially empty.</p>
    <p>Each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent②">user agent</a> has an associated <a data-link-type="dfn" href="#browsing-topics-types-taxonomy" id="ref-for-browsing-topics-types-taxonomy①">taxonomy</a> <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-taxonomy">taxonomy</dfn> (identified by <a data-link-type="dfn" href="#browsing-topics-types-taxonomy-version" id="ref-for-browsing-topics-types-taxonomy-version①">taxonomy version</a> <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-taxonomy-version">taxonomy version</dfn>) and <a data-link-type="dfn" href="#browsing-topics-types-model" id="ref-for-browsing-topics-types-model">model</a> <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-model">model</dfn> (identified by <a data-link-type="dfn" href="#browsing-topics-types-model-version" id="ref-for-browsing-topics-types-model-version①">model version</a> <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-model-version">model version</dfn>).</p>
    <p>The <a data-link-type="dfn" href="#user-agent-taxonomy" id="ref-for-user-agent-taxonomy">taxonomy</a> and <a data-link-type="dfn" href="#user-agent-model" id="ref-for-user-agent-model">model</a> may be shipped to the browser asynchronously w.r.t. the browser release, and may be unavailable at a given point. They must be updated atomically w.r.t. algorithms that access them (e.g. the <a data-link-type="dfn" href="#calculate-user-topics" id="ref-for-calculate-user-topics">calculate user topics</a> algorithm).</p>
    <p class="note" role="note"><span class="marker">Note:</span> The initial taxonomy used by the API is <a href="https://github.com/patcg-individual-drafts/topics/blob/main/taxonomy_v1.md">taxonomy_v1.md</a> and the expectation is that it will change over time.</p>
    <p>Each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#user-agent" id="ref-for-user-agent③">user agent</a> has an associated topics algorithm configuration (identified by <a data-link-type="dfn" href="#browsing-topics-types-configuration-version" id="ref-for-browsing-topics-types-configuration-version①">configuration version</a> <dfn class="dfn-paneled" data-dfn-for="user agent" data-dfn-type="dfn" data-noexport id="user-agent-configuration-version">configuration version</dfn>). The initial value and meaning is browser defined.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#browsing-topics-types-configuration-version" id="ref-for-browsing-topics-types-configuration-version②">configuration version</a> allows the browser vender to provide algorithms different from the ones specified in this specification. For example, for some of the algorithms in this specification, it may be possible to use a different constant value, while the system overall still has utility and <a href="#privacy-considerations-header">meets the privacy goals</a>.</p>
    <p>When <a data-link-type="dfn" href="#user-agent-configuration-version" id="ref-for-user-agent-configuration-version">configuration version</a> is updated, the browser must properly migrate or delete data in <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state">user topics state</a> and <a data-link-type="dfn" href="#user-agent-topics-history-storage" id="ref-for-user-agent-topics-history-storage">topics history storage</a> so that the state and the configuration are consistent.</p>
    <h2 class="heading settled" data-level="4" id="browsing-topic-dictionary-header"><span class="secno">4. </span><span class="content">BrowsingTopic dictionary</span><a class="self-link" href="#browsing-topic-dictionary-header"></a></h2>
     The <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic">BrowsingTopic</a></code> dictionary is used to contain the IDL correspondences of <a data-link-type="dfn" href="#browsing-topics-types-topic-ids" id="ref-for-browsing-topics-types-topic-ids⑦">topic id</a>, <a data-link-type="dfn" href="#browsing-topics-types-version" id="ref-for-browsing-topics-types-version">version</a>, <a data-link-type="dfn" href="#browsing-topics-types-configuration-version" id="ref-for-browsing-topics-types-configuration-version③">configuration version</a>, <a data-link-type="dfn" href="#browsing-topics-types-taxonomy-version" id="ref-for-browsing-topics-types-taxonomy-version②">taxonomy version</a>, and <a data-link-type="dfn" href="#browsing-topics-types-model-version" id="ref-for-browsing-topics-types-model-version②">model version</a>. 
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-browsingtopic"><code><c- g>BrowsingTopic</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange" id="ref-for-EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="BrowsingTopic" data-dfn-type="dict-member" data-export data-type="unsigned long long " id="dom-browsingtopic-topic"><code><c- g>topic</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="BrowsingTopic" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-browsingtopic-version"><code><c- g>version</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="BrowsingTopic" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-browsingtopic-configversion"><code><c- g>configVersion</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="BrowsingTopic" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-browsingtopic-modelversion"><code><c- g>modelVersion</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="BrowsingTopic" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-browsingtopic-taxonomyversion"><code><c- g>taxonomyVersion</c-></code></dfn>;
};
</pre>
    <div class="example" id="example-5217d869"><a class="self-link" href="#example-5217d869"></a> An example <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic①">BrowsingTopic</a></code> object from Chrome: <code class="highlight"><c- p>{</c-> configVersion<c- o>:</c-> <c- u>"chrome.1"</c-><c- p>,</c-> modelVersion<c- o>:</c-> <c- u>"2206021246"</c-><c- p>,</c-> taxonomyVersion<c- o>:</c-> <c- u>"1"</c-><c- p>,</c-> topic<c- o>:</c-> <c- mf>43</c-><c- p>,</c-> version<c- o>:</c-> <c- u>"chrome.1:1:2206021246"</c-> <c- p>}</c-></code>. </div>
    <div class="algorithm" data-algorithm="code unit less than" data-algorithm-for="browsing-topic">
      A <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic②">BrowsingTopic</a></code> dictionary <var>a</var> is <dfn class="dfn-paneled" data-dfn-for="browsing-topic" data-dfn-type="dfn" data-noexport id="browsing-topics-dictionary-less-than-comparator">code unit less than</dfn> a <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic③">BrowsingTopic</a></code> dictionary <var>b</var> if the following steps return true: 
     <ol>
      <li data-md>
       <p>If <var>a</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-topic" id="ref-for-dom-browsingtopic-topic">topic</a></code>"] &lt; <var>b</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-topic" id="ref-for-dom-browsingtopic-topic①">topic</a></code>"], then return true.</p>
      <li data-md>
       <p>If <var>a</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-version" id="ref-for-dom-browsingtopic-version">version</a></code>"] is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-unit-less-than" id="ref-for-code-unit-less-than">code unit less than</a> <var>b</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-version" id="ref-for-dom-browsingtopic-version①">version</a></code>"], then return true.</p>
      <li data-md>
       <p>Return false.</p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="document-id-header"><span class="secno">5. </span><span class="content">document ID</span><a class="self-link" href="#document-id-header"></a></h2>
     Each <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> has a <dfn class="dfn-paneled" data-dfn-for="document-id-header" data-dfn-type="dfn" data-noexport id="document-id-header-document-id">document id</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> unique identifier shared with no other <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code> objects. 
    <h2 class="heading settled" data-level="6" id="determine-topics-calculation-input-data-header"><span class="secno">6. </span><span class="content">Determine topics calculation input data</span><a class="self-link" href="#determine-topics-calculation-input-data-header"></a></h2>
     Given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code>, the browser must have a way to determine the <dfn class="dfn-paneled" data-dfn-for="determine-topics-calculation-input-data-header" data-dfn-type="dfn" data-noexport id="determine-topics-calculation-input-data-header-topics-calculation-input-data">topics calculation input data</dfn>. <a data-link-type="dfn" href="#determine-topics-calculation-input-data-header-topics-calculation-input-data" id="ref-for-determine-topics-calculation-input-data-header-topics-calculation-input-data">topics calculation input data</a> is a string that encodes the attributes to be used for topics classification. The attributes could be the document’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url">URL</a>, the URL’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-domain" id="ref-for-concept-domain①">domain</a>, the document node’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-descendant-text-content" id="ref-for-concept-descendant-text-content">descendant text content</a>, etc, as determined by the browser vendor. 
    <p class="note" role="note"><span class="marker">Note:</span> In Chrome’s experimentation phase, the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host" id="ref-for-concept-url-host">host</a> of a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code>'s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-url" id="ref-for-concept-document-url①">URL</a> is used as the <a data-link-type="dfn" href="#determine-topics-calculation-input-data-header-topics-calculation-input-data" id="ref-for-determine-topics-calculation-input-data-header-topics-calculation-input-data①">topics calculation input data</a>, and the model is trained with human curated hostnames and topics.</p>
    <h2 class="heading settled" data-level="7" id="collect-page-topics-calculation-input-data-header"><span class="secno">7. </span><span class="content">Collect page topics calculation input data</span><a class="self-link" href="#collect-page-topics-calculation-input-data-header"></a></h2>
    <div class="algorithm" data-algorithm="collect page topics calculation input data">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="collect-page-topics-calculation-input-data">collect page topics calculation input data</dfn>, given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code> <var>document</var>: 
     <ol>
      <li data-md>
       <p>If <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" id="ref-for-node-navigable">node navigable</a> is a <a data-link-type="dfn" href="https://wicg.github.io/nav-speculation/prerendering.html#prerendering-navigable" id="ref-for-prerendering-navigable">prerendering navigable</a>, then append the following steps to <var>document</var>’s <a data-link-type="dfn" href="https://wicg.github.io/nav-speculation/prerendering.html#platform-object-post-prerendering-activation-steps-list" id="ref-for-platform-object-post-prerendering-activation-steps-list">post-prerendering activation steps list</a> and return. Else, run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>:</p>
       <ol>
        <li data-md>
         <p>Let <var>documentId</var> be <var>document</var>’s <a data-link-type="dfn" href="#document-id-header-document-id" id="ref-for-document-id-header-document-id">document id</a>.</p>
        <li data-md>
         <p>If user agent’s <a data-link-type="dfn" href="#user-agent-topics-history-storage" id="ref-for-user-agent-topics-history-storage①">topics history storage</a> contains a <a data-link-type="dfn" href="#browsing-topics-types-topics-history-entry" id="ref-for-browsing-topics-types-topics-history-entry①">topics history entry</a> whose <a data-link-type="dfn" href="#topics-history-entry-document-id" id="ref-for-topics-history-entry-document-id">document id</a> is <var>documentId</var>, return.</p>
        <li data-md>
         <p>Let <var>topicsHistoryEntry</var> be a <a data-link-type="dfn" href="#browsing-topics-types-topics-history-entry" id="ref-for-browsing-topics-types-topics-history-entry②">topics history entry</a>.</p>
        <li data-md>
         <p>Set <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-document-id" id="ref-for-topics-history-entry-document-id①">document id</a> to <var>documentId</var>.</p>
        <li data-md>
         <p>Set <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-topics-calculation-input-data" id="ref-for-topics-history-entry-topics-calculation-input-data">topics calculation input data</a> to the <a data-link-type="dfn" href="#determine-topics-calculation-input-data-header-topics-calculation-input-data" id="ref-for-determine-topics-calculation-input-data-header-topics-calculation-input-data②">topics calculation input data</a> for <var>document</var>.</p>
        <li data-md>
         <p>Let <var>unsafeMoment</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock">wall clock</a>'s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0" id="ref-for-dfn-unsafe-current-time-0">unsafe current time</a>.</p>
        <li data-md>
         <p>Let <var>moment</var> be the result of running <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-coarsen-time" id="ref-for-dfn-coarsen-time">coarsen time</a> algorithm given <var>unsafeMoment</var> and <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock①">wall clock</a> as input.</p>
        <li data-md>
         <p>Let <var>fromUnixEpochTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from">duration from</a> the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch">Unix epoch</a> to <var>moment</var>.</p>
        <li data-md>
         <p>Set <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-time" id="ref-for-topics-history-entry-time">time</a> to <var>fromUnixEpochTime</var>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>topicsHistoryEntry</var> to user agent’s <a data-link-type="dfn" href="#user-agent-topics-history-storage" id="ref-for-user-agent-topics-history-storage②">topics history storage</a>.</p>
       </ol>
     </ol>
    </div>
    <h2 class="heading settled" data-level="8" id="collect-topics-caller-origin-header"><span class="secno">8. </span><span class="content">Collect topics caller origin</span><a class="self-link" href="#collect-topics-caller-origin-header"></a></h2>
    <div class="algorithm" data-algorithm="collect topics caller origin">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="collect-topics-caller-origin">collect topics caller origin</dfn>, given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code> <var>document</var> and an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">origin</a> <var>callerOrigin</var>: 
     <ol>
      <li data-md>
       <p>Run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①">in parallel</a>:</p>
       <ol>
        <li data-md>
         <p>Let <var>documentId</var> be <var>document</var>’s <a data-link-type="dfn" href="#document-id-header-document-id" id="ref-for-document-id-header-document-id①">document id</a>.</p>
        <li data-md>
         <p>If user agent’s <a data-link-type="dfn" href="#user-agent-topics-history-storage" id="ref-for-user-agent-topics-history-storage③">topics history storage</a> does not contain a <a data-link-type="dfn" href="#browsing-topics-types-topics-history-entry" id="ref-for-browsing-topics-types-topics-history-entry③">topics history entry</a> whose <a data-link-type="dfn" href="#topics-history-entry-document-id" id="ref-for-topics-history-entry-document-id②">document id</a> is <var>documentId</var>, return.</p>
        <li data-md>
         <p>Let <var>topicsHistoryEntry</var> be the <a data-link-type="dfn" href="#browsing-topics-types-topics-history-entry" id="ref-for-browsing-topics-types-topics-history-entry④">topics history entry</a> in user agent’s <a data-link-type="dfn" href="#user-agent-topics-history-storage" id="ref-for-user-agent-topics-history-storage④">topics history storage</a> whose <a data-link-type="dfn" href="#topics-history-entry-document-id" id="ref-for-topics-history-entry-document-id③">document id</a> is <var>documentId</var>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>callerOrigin</var> to <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-topics-caller-origins" id="ref-for-topics-history-entry-topics-caller-origins">topics caller origins</a>.</p>
       </ol>
     </ol>
    </div>
    <h2 class="heading settled" data-level="9" id="periodically-calculate-user-topics-header"><span class="secno">9. </span><span class="content">Periodically calculate user topics</span><a class="self-link" href="#periodically-calculate-user-topics-header"></a></h2>
    <p>At the start of a browser session, run the <a data-link-type="dfn" href="#schedule-user-topics-calculation" id="ref-for-schedule-user-topics-calculation">schedule user topics calculation</a> algorithm.</p>
    <div class="algorithm" data-algorithm="schedule user topics calculation">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="schedule-user-topics-calculation">schedule user topics calculation</dfn>, perform the following steps: 
     <ol>
      <li data-md>
       <p>Let <var>unsafeMoment</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock②">wall clock</a>'s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0" id="ref-for-dfn-unsafe-current-time-0①">unsafe current time</a>.</p>
      <li data-md>
       <p>Let <var>moment</var> be the result of running <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-coarsen-time" id="ref-for-dfn-coarsen-time①">coarsen time</a> algorithm given <var>unsafeMoment</var> and <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock③">wall clock</a> as input.</p>
      <li data-md>
       <p>Let <var>fromUnixEpochTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from①">duration from</a> the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch①">Unix epoch</a> to <var>moment</var>.</p>
      <li data-md>
       <p>Let <var>presumedNextCalculationDelay</var> be a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration">duration</a> of 0.</p>
      <li data-md>
       <p>If user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state①">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs①">epochs</a> is not empty:</p>
       <ol>
        <li data-md>
         <p>Let <var>numEpochs</var> be user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state②">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs②">epochs</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a>.</p>
        <li data-md>
         <p>Let <var>lastTopicsCalculationTime</var> beuser agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state③">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs③">epochs</a>[<var>numEpochs</var> − 1].</p>
        <li data-md>
         <p>Let <var>presumedNextCalculationDelay</var> be <var>lastTopicsCalculationTime</var> + (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration①">duration</a> of 7 days) − <var>fromUnixEpochTime</var>.</p>
        <li data-md>
         <p>If <var>presumedNextCalculationDelay</var> &lt; (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration②">duration</a> of 0), then set <var>presumedNextCalculationDelay</var> to (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration③">duration</a> of 0).</p>
        <li data-md>
         <p>Else if <var>presumedNextCalculationDelay</var> ≥ (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration④">duration</a> of 14 days), then set <var>presumedNextCalculationDelay</var> to (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration⑤">duration</a> of 0).</p>
         <p class="note" role="note"><span class="marker">Note:</span> This could happen if the machine time has gone backward since the last topics calculation. Recalculate immediately to align with the expected schedule rather than potentially stop calculating for a very long time.</p>
       </ol>
      <li data-md>
       <p>Schedule the <a data-link-type="dfn" href="#calculate-user-topics" id="ref-for-calculate-user-topics①">calculate user topics</a> algorithm to run at <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch②">Unix epoch</a> + <var>fromUnixEpochTime</var> + <var>presumedNextCalculationDelay</var>.</p>
     </ol>
    </div>
    <div class="algorithm" data-algorithm="calculate user topics">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calculate-user-topics">calculate user topics</dfn>, perform the following steps: 
     <ol>
      <li data-md>
       <p>Let <var>unsafeMoment</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock④">wall clock</a>'s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0" id="ref-for-dfn-unsafe-current-time-0②">unsafe current time</a>.</p>
      <li data-md>
       <p>Let <var>moment</var> be the result of running <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-coarsen-time" id="ref-for-dfn-coarsen-time②">coarsen time</a> algorithm given <var>unsafeMoment</var> and <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock⑤">wall clock</a> as input.</p>
      <li data-md>
       <p>Let <var>fromUnixEpochTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from②">duration from</a> the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch③">Unix epoch</a> to <var>moment</var>.</p>
      <li data-md>
       <p>If either user agent’s <a data-link-type="dfn" href="#user-agent-model" id="ref-for-user-agent-model①">model</a> or <a data-link-type="dfn" href="#user-agent-taxonomy" id="ref-for-user-agent-taxonomy①">taxonomy</a> isn’t available:</p>
       <ol>
        <li data-md>
         <p>Let <var>epoch</var> be an <a data-link-type="dfn" href="#browsing-topics-types-epoch" id="ref-for-browsing-topics-types-epoch①">epoch</a> struct with default initial field values.</p>
        <li data-md>
         <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-time" id="ref-for-epoch-time">time</a> to <var>fromUnixEpochTime</var>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">Append</a> <var>epoch</var> to user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state④">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs④">epochs</a>.</p>
        <li data-md>
         <p>If user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state⑤">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs⑤">epochs</a> has more than 4 entries, remove the oldest epoch (i.e. the epoch with index 0).</p>
        <li data-md>
         <p>Schedule this <a data-link-type="dfn" href="#calculate-user-topics" id="ref-for-calculate-user-topics②">calculate user topics</a> algorithm to run at <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch④">Unix epoch</a> + <var>fromUnixEpochTime</var> + (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration⑥">duration</a> of 7 days).</p>
        <li data-md>
         <p>Return.</p>
       </ol>
      <li data-md>
       <p>Let <var>topicsCount</var> be an empty map.</p>
      <li data-md>
       <p>Let <var>topicsCallers</var> be an empty map.</p>
      <li data-md>
       <p>Let <var>userTopicsDataStartTime</var> be <var>fromUnixEpochTime</var> − (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration⑦">duration</a> of 7 days).</p>
      <li data-md>
       <p>Let <var>topicsCallerDataStartTime</var> be <var>fromUnixEpochTime</var> − (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration⑧">duration</a> of 21 days).</p>
      <li data-md>
       <p>For each <a data-link-type="dfn" href="#browsing-topics-types-topics-history-entry" id="ref-for-browsing-topics-types-topics-history-entry⑤">topics history entry</a> <var>topicsHistoryEntry</var> in user agent’s <a data-link-type="dfn" href="#user-agent-topics-history-storage" id="ref-for-user-agent-topics-history-storage⑤">topics history storage</a>:</p>
       <ol>
        <li data-md>
         <p>Let <var>visitTime</var> be <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-time" id="ref-for-topics-history-entry-time①">time</a>.</p>
        <li data-md>
         <p>If <var>visitTime</var> is before <var>topicsCallerDataStartTime</var>, then continue.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="#classify" id="ref-for-classify">Classify</a> <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-topics-calculation-input-data" id="ref-for-topics-history-entry-topics-calculation-input-data①">topics calculation input data</a> into <var>topicIds</var>.</p>
        <li data-md>
         <p>For each <var>topicId</var> in <var>topicIds</var>:</p>
         <ol>
          <li data-md>
           <p>If <var>topicsCallers</var>[<var>topicId</var>] does not exist:</p>
           <ol>
            <li data-md>
             <p>Initialize <var>topicsCallers</var>[<var>topicId</var>] to be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a>.</p>
           </ol>
          <li data-md>
           <p>If <var>topicsCount</var>[<var>topicId</var>] does not exist:</p>
           <ol>
            <li data-md>
             <p>Initialize <var>topicsCount</var>[<var>topicId</var>] to 0.</p>
           </ol>
          <li data-md>
           <p>For each <var>callerOrigin</var> in <var>topicsHistoryEntry</var>’s <a data-link-type="dfn" href="#topics-history-entry-topics-caller-origins" id="ref-for-topics-history-entry-topics-caller-origins①">topics caller origins</a>:</p>
           <ol>
            <li data-md>
             <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">Append</a> <var>callerOrigin</var> to <var>topicsCallers</var>[<var>topicId</var>].</p>
           </ol>
          <li data-md>
           <p>If <var>visitTime</var> is greater than <var>userTopicsDataStartTime</var>:</p>
           <ol>
            <li data-md>
             <p>Increment <var>topicsCount</var>[<var>topicId</var>] by 1.</p>
           </ol>
         </ol>
       </ol>
      <li data-md>
       <p>Let <var>top5Topics</var> be a list containing the top up to 5 <var>topicId</var>s in <var>topicsCount</var>’s keys set, where the <var>topicId</var>s with more count are retrieved first.</p>
      <li data-md>
       <p>If <var>top5Topics</var> has less than 5 entries:</p>
       <ol>
        <li data-md>
         <p>Pad <var>top5Topics</var> with random topic ids from user agent’s <a data-link-type="dfn" href="#user-agent-taxonomy" id="ref-for-user-agent-taxonomy②">taxonomy</a>, until <var>top5Topics</var> has 5 entries.</p>
       </ol>
      <li data-md>
       <p>Let <var>top5TopicsWithCallerOrigins</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">list</a>.</p>
      <li data-md>
       <p>For each <var>topTopicId</var> in <var>top5Topics</var>:</p>
       <ol>
        <li data-md>
         <p>Let <var>topicWithCallerOrigins</var> be a <a data-link-type="dfn" href="#browsing-topics-types-topic-with-caller-origins" id="ref-for-browsing-topics-types-topic-with-caller-origins①">topic with caller origins</a> struct with <a data-link-type="dfn" href="#topic-with-caller-origins-topic-id" id="ref-for-topic-with-caller-origins-topic-id">topic id</a> initially 0 and <a data-link-type="dfn" href="#topic-with-caller-origins-caller-origins" id="ref-for-topic-with-caller-origins-caller-origins">caller origins</a> initially empty.</p>
        <li data-md>
         <p>If <var>topTopicId</var> is allowed by user preference setting:</p>
         <ol>
          <li data-md>
           <p>Set <var>topicWithCallerOrigins</var>’s <a data-link-type="dfn" href="#topic-with-caller-origins-topic-id" id="ref-for-topic-with-caller-origins-topic-id①">topic id</a> to <var>topicId</var>.</p>
          <li data-md>
           <p>Let <var>topicWithDescendantIds</var> be the result of running <a data-link-type="dfn" href="#get-descendant-topics" id="ref-for-get-descendant-topics">get descendant topics</a> given <var>topTopicId</var>.</p>
          <li data-md>
           <p>Add <var>topTopicId</var> to <var>topicWithDescendantIds</var>.</p>
          <li data-md>
           <p>For each <var>topicId</var> in <var>topicWithDescendantIds</var>:</p>
           <ol>
            <li data-md>
             <p>If <var>topicId</var> is allowed by user preference setting:</p>
             <ol>
              <li data-md>
               <p>Insert all elements in <var>topicsCallers</var>[<var>topicId</var>] to <var>topicWithCallerOrigins</var>’s <a data-link-type="dfn" href="#topic-with-caller-origins-caller-origins" id="ref-for-topic-with-caller-origins-caller-origins①">caller origins</a>.</p>
             </ol>
           </ol>
         </ol>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append③">Append</a> <var>topicWithCallerOrigins</var> to <var>top5TopicsWithCallerOrigins</var>.</p>
       </ol>
      <li data-md>
       <p>Let <var>epoch</var> be an <a data-link-type="dfn" href="#browsing-topics-types-epoch" id="ref-for-browsing-topics-types-epoch②">epoch</a> struct with default initial field values.</p>
      <li data-md>
       <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-taxonomy" id="ref-for-epoch-taxonomy">taxonomy</a> to user agent’s <a data-link-type="dfn" href="#user-agent-taxonomy" id="ref-for-user-agent-taxonomy③">taxonomy</a>.</p>
      <li data-md>
       <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-taxonomy-version" id="ref-for-epoch-taxonomy-version">taxonomy version</a> to user agent’s <a data-link-type="dfn" href="#user-agent-taxonomy-version" id="ref-for-user-agent-taxonomy-version">taxonomy version</a>.</p>
      <li data-md>
       <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-model-version" id="ref-for-epoch-model-version">model version</a> to user agent’s <a data-link-type="dfn" href="#user-agent-model-version" id="ref-for-user-agent-model-version">model version</a>.</p>
      <li data-md>
       <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-config-version" id="ref-for-epoch-config-version">config version</a> to user agent’s <a data-link-type="dfn" href="#user-agent-configuration-version" id="ref-for-user-agent-configuration-version①">configuration version</a>.</p>
      <li data-md>
       <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-top-5-topics-with-caller-origins" id="ref-for-epoch-top-5-topics-with-caller-origins">top 5 topics with caller origins</a> to <var>top5TopicsWithCallerOrigins</var>.</p>
      <li data-md>
       <p>Set <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-time" id="ref-for-epoch-time①">time</a> to <var>fromUnixEpochTime</var>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append④">Append</a> <var>epoch</var> to user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state⑥">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs⑥">epochs</a>.</p>
      <li data-md>
       <p>If user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state⑦">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs⑦">epochs</a> has more than 4 entries, remove the oldest epoch.</p>
      <li data-md>
       <p>Schedule this <a data-link-type="dfn" href="#calculate-user-topics" id="ref-for-calculate-user-topics③">calculate user topics</a> algorithm to run at <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch⑤">Unix epoch</a> + <var>fromUnixEpochTime</var> + (a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration⑨">duration</a> of 7 days).</p>
     </ol>
    </div>
    <h2 class="heading settled" data-level="10" id="epochs-for-caller-header"><span class="secno">10. </span><span class="content">Epochs for caller</span><a class="self-link" href="#epochs-for-caller-header"></a></h2>
    <div class="algorithm" data-algorithm="calculate the epochs for caller">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calculate-the-epochs-for-caller">calculate the epochs for caller</dfn>, given a <a data-link-type="dfn" href="#browsing-topics-types-topics-caller-context" id="ref-for-browsing-topics-types-topics-caller-context">topics caller context</a> <var>callerContext</var>, perform the following steps. They return a list of <a data-link-type="dfn" href="#browsing-topics-types-epoch" id="ref-for-browsing-topics-types-epoch③">epoch</a>. 
     <ol>
      <li data-md>
       <p>Let <var>epochs</var> be user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state⑧">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-epochs" id="ref-for-user-topics-state-epochs⑧">epochs</a>.</p>
      <li data-md>
       <p>If <var>epochs</var> is empty, then return an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">list</a>.</p>
      <li data-md>
       <p>Let <var>numEpochs</var> be <var>epochs</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">size</a>.</p>
      <li data-md>
       <p>Let <var>lastEpochTime</var> be <var>epochs</var>[<var>numEpochs</var> − 1]'s <a data-link-type="dfn" href="#epoch-time" id="ref-for-epoch-time②">time</a>.</p>
      <li data-md>
       <p>Let <var>epochSwitchTimeDecisionHash</var> be64 bit truncation of the output of the <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc6234#section-8.3" id="ref-for-section-8.3">HMAC algorithm</a>, given input parameters: whichSha=SHA256, key=user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state⑨">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-hmac-key" id="ref-for-user-topics-state-hmac-key①">hmac key</a>, and message_array=the concatenation of "epoch-switch-time-decision|" and <var>callerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain">top level context domain</a>.</p>
      <li data-md>
       <p>Let <var>epochSwitchTimeDelayIntroduction</var> be a <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration" id="ref-for-dfn-duration①⓪">duration</a> of (<var>epochSwitchTimeDecisionHash</var> % 172800) seconds (i.e. 172800 is 2 days in seconds).</p>
      <li data-md>
       <p>Let <var>timestamp</var> be <var>callerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-timestamp" id="ref-for-topics-caller-context-timestamp">timestamp</a>.</p>
      <li data-md>
       <p>Let <var>result</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">list</a>.</p>
      <li data-md>
       <p>Let <var>startEpochIndex</var> be -1.</p>
      <li data-md>
       <p>Let <var>endEpochIndex</var> be -1.</p>
      <li data-md>
       <p>If <var>timestamp</var> ≤ <var>lastEpochTime</var> + <var>epochSwitchTimeDelayIntroduction</var>:</p>
       <ol>
        <li data-md>
         <p>Set <var>startEpochIndex</var> to max(<var>numEpochs</var> − 4, 0).</p>
        <li data-md>
         <p>Set <var>endEpochIndex</var> to <var>numEpochs</var> − 2.</p>
       </ol>
      <li data-md>
       <p>Else:</p>
       <ol>
        <li data-md>
         <p>Set <var>startEpochIndex</var> to max(<var>numEpochs</var> − 1, 0).</p>
        <li data-md>
         <p>Set <var>endEpochIndex</var> to <var>numEpochs</var> − 1.</p>
       </ol>
      <li data-md>
       <p>If <var>endEpochIndex</var> ≥ 0:</p>
       <ol>
        <li data-md>
         <p>Let <var>i</var> bestartEpochIndex.</p>
        <li data-md>
         <p>While <var>i</var> ≤ <var>endEpochIndex</var>:</p>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑤">Append</a> <var>epochs</var>[<var>i</var>] to <var>result</var>.</p>
          <li data-md>
           <p>Set <var>i</var> to <var>i</var> + 1.</p>
         </ol>
       </ol>
      <li data-md>
       <p>Return <var>result</var>.</p>
     </ol>
    </div>
    <h2 class="heading settled" data-level="11" id="topics-for-caller-header"><span class="secno">11. </span><span class="content">Topics for caller</span><a class="self-link" href="#topics-for-caller-header"></a></h2>
    <div class="algorithm" data-algorithm="calculate the topics for caller">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="calculate-the-topics-for-caller">calculate the topics for caller</dfn>, given a <a data-link-type="dfn" href="#browsing-topics-types-topics-caller-context" id="ref-for-browsing-topics-types-topics-caller-context①">topics caller context</a> <var>callerContext</var>, perform the following steps. They return a list of <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic④">BrowsingTopic</a></code>s. 
     <ol>
      <li data-md>
       <p>Let <var>epochs</var> be the result of running the <a data-link-type="dfn" href="#calculate-the-epochs-for-caller" id="ref-for-calculate-the-epochs-for-caller">calculate the epochs for caller</a> algorithm given <var>callerContext</var> as input.</p>
      <li data-md>
       <p>Let <var>result</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">list</a>.</p>
      <li data-md>
       <p>For each <var>epoch</var> in <var>epochs</var>:</p>
       <ol>
        <li data-md>
         <p>If <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-top-5-topics-with-caller-origins" id="ref-for-epoch-top-5-topics-with-caller-origins①">top 5 topics with caller origins</a> is empty (implying the topics calculation failed for that epoch), then continue.</p>
        <li data-md>
         <p>Let <var>topic</var> be null.</p>
        <li data-md>
         <p>Let <var>topTopicIndexDecisionHash</var> be64 bit truncation of the output of the <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc6234#section-8.3" id="ref-for-section-8.3①">HMAC algorithm</a>, given input parameters: whichSha=SHA256, key=user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state①⓪">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-hmac-key" id="ref-for-user-topics-state-hmac-key②">hmac key</a>, and message_array=the concatenation of "top-topic-index-decision|", <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-time" id="ref-for-epoch-time③">time</a>, and <var>callerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain①">top level context domain</a></p>
        <li data-md>
         <p>Let <var>topTopicIndex</var> be <var>topTopicIndexDecisionHash</var> % 5.</p>
        <li data-md>
         <p>Let <var>topTopicWithCallerOrigins</var> be <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-top-5-topics-with-caller-origins" id="ref-for-epoch-top-5-topics-with-caller-origins②">top 5 topics with caller origins</a>[<var>topTopicIndex</var>].</p>
        <li data-md>
         <p>If <var>topTopicWithCallerOrigins</var>’s <a data-link-type="dfn" href="#topic-with-caller-origins-caller-origins" id="ref-for-topic-with-caller-origins-caller-origins②">caller origins</a> contains <var>callerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-caller-origin" id="ref-for-topics-caller-context-caller-origin">caller origin</a>:</p>
         <ol>
          <li data-md>
           <p>Set <var>topic</var> to an empty <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic⑤">BrowsingTopic</a></code> dictionary.</p>
          <li data-md>
           <p>Set <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-topic" id="ref-for-dom-browsingtopic-topic②">topic</a></code>"] to <var>topTopicWithCallerOrigins</var>’s <a data-link-type="dfn" href="#topic-with-caller-origins-topic-id" id="ref-for-topic-with-caller-origins-topic-id②">topic id</a>.</p>
         </ol>
        <li data-md>
         <p>If <var>topic</var> is null, or if <var>topic</var>’s <code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-topic" id="ref-for-dom-browsingtopic-topic③">topic</a></code> is 0 (i.e. the candidate topic was cleared), then continue.</p>
        <li data-md>
         <p>Let <var>randomOrTopTopicDecisionHash</var> be 64 bit truncation of the output of the <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc6234#section-8.3" id="ref-for-section-8.3②">HMAC algorithm</a>, given input parameters: whichSha=SHA256, key=user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state①①">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-hmac-key" id="ref-for-user-topics-state-hmac-key③">hmac key</a>, and message_array=the concatenation of "random-or-top-topic-decision|", <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-time" id="ref-for-epoch-time④">time</a>, and <var>callerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain②">top level context domain</a>.</p>
        <li data-md>
         <p>If <var>randomOrTopTopicDecisionHash</var> % 100 &lt; 5:</p>
         <ol>
          <li data-md>
           <p>Let <var>randomTopicIndexDecisionHash</var> be64 bit truncation of the output of the <a data-link-type="dfn" href="https://www.rfc-editor.org/rfc/rfc6234#section-8.3" id="ref-for-section-8.3③">HMAC algorithm</a>, given input parameters: whichSha=SHA256, key=user agent’s <a data-link-type="dfn" href="#user-agent-user-topics-state" id="ref-for-user-agent-user-topics-state①②">user topics state</a>'s <a data-link-type="dfn" href="#user-topics-state-hmac-key" id="ref-for-user-topics-state-hmac-key④">hmac key</a>, and message_array=the concatenation of "random-topic-index-decision|", <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-time" id="ref-for-epoch-time⑤">time</a>, and <var>callerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain③">top level context domain</a>.</p>
          <li data-md>
           <p>Let <var>randomTopicIndex</var> be <var>randomTopicIndexDecisionHash</var> % <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-taxonomy" id="ref-for-epoch-taxonomy①">taxonomy</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size②">size</a>.</p>
          <li data-md>
           <p>Set <var>topic</var>’s <code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-topic" id="ref-for-dom-browsingtopic-topic④">topic</a></code> to <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-taxonomy" id="ref-for-epoch-taxonomy②">taxonomy</a>[<var>randomTopicIndex</var>].</p>
         </ol>
        <li data-md>
         <p>Set <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-configversion" id="ref-for-dom-browsingtopic-configversion">configVersion</a></code>"] to to <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-config-version" id="ref-for-epoch-config-version①">config version</a>.</p>
        <li data-md>
         <p>Set <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-modelversion" id="ref-for-dom-browsingtopic-modelversion">modelVersion</a></code> to"] <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-model-version" id="ref-for-epoch-model-version①">model version</a>.</p>
        <li data-md>
         <p>Set <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-taxonomyversion" id="ref-for-dom-browsingtopic-taxonomyversion">taxonomyVersion</a></code>"] to <var>epoch</var>’s <a data-link-type="dfn" href="#epoch-taxonomy-version" id="ref-for-epoch-taxonomy-version①">taxonomy version</a>.</p>
        <li data-md>
         <p>Determine the <a data-link-type="dfn" href="#browsing-topics-types-version" id="ref-for-browsing-topics-types-version①">version</a> <var>version</var>, given <var>topic</var>’s <code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-configversion" id="ref-for-dom-browsingtopic-configversion①">configVersion</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-modelversion" id="ref-for-dom-browsingtopic-modelversion①">modelVersion</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-taxonomyversion" id="ref-for-dom-browsingtopic-taxonomyversion①">taxonomyVersion</a></code> as input.</p>
        <li data-md>
         <p>Set <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-version" id="ref-for-dom-browsingtopic-version②">version</a></code>"] to <var>version</var>.</p>
        <li data-md>
         <p>Add <var>topic</var> to <var>result</var>.</p>
       </ol>
      <li data-md>
       <p>Sort entries in <var>result</var> given the <a href="#browsing-topics-dictionary-less-than-comparator" id="ref-for-browsing-topics-dictionary-less-than-comparator">less-than comparator</a> for the <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic⑥">BrowsingTopic</a></code> dictionary.</p>
      <li data-md>
       <p>Remove duplicate entries in <var>result</var>. Two <code class="idl"><a data-link-type="idl" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic⑦">BrowsingTopic</a></code> dictionaries <var>a</var> and <var>b</var> are considered equal if <var>a</var> is not <a data-link-type="dfn" href="#browsing-topics-dictionary-less-than-comparator" id="ref-for-browsing-topics-dictionary-less-than-comparator②">code unit less than</a> <var>b</var> and <var>b</var> is not <a data-link-type="dfn" href="#browsing-topics-dictionary-less-than-comparator" id="ref-for-browsing-topics-dictionary-less-than-comparator①">code unit less than</a> <var>a</var>.</p>
      <li data-md>
       <p>Return <var>result</var>.</p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="12" id="the-javascript-api-header"><span class="secno">12. </span><span class="content">The JavaScript API</span><a class="self-link" href="#the-javascript-api-header"></a></h2>
    <p>The Topics API lives under the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code> interface, and is only available if the document is in <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context">secure context</a>.</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-browsingtopicsoptions"><code><c- g>BrowsingTopicsOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="BrowsingTopicsOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-browsingtopicsoptions-skipobservation"><code><c- g>skipObservation</c-></code></dfn> = <c- b>false</c->;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑦"><c- g>Document</c-></a> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-browsingtopic" id="ref-for-dictdef-browsingtopic⑧"><c- n>BrowsingTopic</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-document-browsingtopics" id="ref-for-dom-document-browsingtopics①"><c- g>browsingTopics</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-browsingtopicsoptions" id="ref-for-dictdef-browsingtopicsoptions"><c- n>BrowsingTopicsOptions</c-></a> <dfn class="idl-code" data-dfn-for="Document/browsingTopics(options), Document/browsingTopics()" data-dfn-type="argument" data-export id="dom-document-browsingtopics-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-document-browsingtopics-options-options"></a></dfn> = {});
};
</pre>
    <div class="algorithm" data-algorithm="browsingTopics(options)">
      The <dfn class="dfn-paneled idl-code" data-dfn-for="Document" data-dfn-type="method" data-export data-lt="browsingTopics(options)|browsingTopics()" id="dom-document-browsingtopics"><code>browsingTopics(options)</code></dfn> method steps are: 
     <ol>
      <li data-md>
       <p>Let <var>document</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>.</p>
      <li data-md>
       <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise">a new promise</a>.</p>
      <li data-md>
       <p>Let <var>topicsCallerContext</var> be a <a data-link-type="dfn" href="#browsing-topics-types-topics-caller-context" id="ref-for-browsing-topics-types-topics-caller-context②">topics caller context</a>.</p>
      <li data-md>
       <p>Set <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-caller-origin" id="ref-for-topics-caller-context-caller-origin①">caller origin</a> to <var>document</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin">origin</a>.</p>
      <li data-md>
       <p>Set <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain④">top level context domain</a> to the result of running <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable" id="ref-for-node-navigable①">node navigable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top">top-level traversable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document" id="ref-for-nav-document">active document</a>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/browsers.html#dom-document-domain" id="ref-for-dom-document-domain">domain</a></code> getter steps.</p>
      <li data-md>
       <p>Let <var>unsafeMoment</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock⑥">wall clock</a>'s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0" id="ref-for-dfn-unsafe-current-time-0③">unsafe current time</a>.</p>
      <li data-md>
       <p>Let <var>moment</var> be the result of running <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-coarsen-time" id="ref-for-dfn-coarsen-time③">coarsen time</a> algorithm given <var>unsafeMoment</var> and <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock⑦">wall clock</a> as input.</p>
      <li data-md>
       <p>Let <var>fromUnixEpochTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from③">duration from</a> the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch⑥">Unix epoch</a> to <var>moment</var>.</p>
      <li data-md>
       <p>Set <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-timestamp" id="ref-for-topics-caller-context-timestamp①">timestamp</a> to <var>fromUnixEpochTime</var>.</p>
      <li data-md>
       <p>If any of the following is true:</p>
       <ul>
        <li data-md>
         <p><var>document</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin①">origin</a> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>.</p>
        <li data-md>
         <p><var>document</var> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use" id="ref-for-allowed-to-use">allowed to use</a> the <code><a href="#browsing-topics-policy-controlled-feature" id="ref-for-browsing-topics-policy-controlled-feature">browsing-topics</a></code> feature.</p>
        <li data-md>
         <p><var>document</var> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use" id="ref-for-allowed-to-use①">allowed to use</a> the <code><a href="#interest-cohort-policy-controlled-feature" id="ref-for-interest-cohort-policy-controlled-feature">interest-cohort</a></code> feature.</p>
        <li data-md>
         <p>The user preference setting disallows the access to topics from <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-caller-origin" id="ref-for-topics-caller-context-caller-origin②">caller origin</a> or <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain⑤">top level context domain</a>.</p>
       </ul>
       <p class="note" role="note"><span class="marker">Note:</span> In Chrome’s experimentation phase, it will additionally require a valid <a href="https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/explainer.md">Origin Trial</a> token to exist in <var>document</var>.</p>
       <p>then:</p>
       <ol>
        <li data-md>
         <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task">Queue a global task</a> on the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="browsing-topics-task-source">browsing topics task source</dfn> given <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject">reject</a> <var>promise</var> with a "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#notallowederror" id="ref-for-notallowederror">NotAllowedError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.</p>
        <li data-md>
         <p>Abort these steps.</p>
       </ol>
      <li data-md>
       <p>Run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel②">in parallel</a>:</p>
       <ol>
        <li data-md>
         <p>Let <var>topics</var> be the result from running the <a data-link-type="dfn" href="#calculate-the-topics-for-caller" id="ref-for-calculate-the-topics-for-caller">calculate the topics for caller</a> algorithm, with <var>topicsCallerContext</var> as input.</p>
        <li data-md>
         <p>If <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopicsoptions-skipobservation" id="ref-for-dom-browsingtopicsoptions-skipobservation">skipObservation</a></code>"] is false:</p>
         <ol>
          <li data-md>
           <p>Run the <a data-link-type="dfn" href="#collect-page-topics-calculation-input-data" id="ref-for-collect-page-topics-calculation-input-data">collect page topics calculation input data</a> algorithm with <var>document</var> as input.</p>
          <li data-md>
           <p>Run the <a data-link-type="dfn" href="#collect-topics-caller-origin" id="ref-for-collect-topics-caller-origin">collect topics caller origin</a> algorithm with <var>document</var> and <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-caller-origin" id="ref-for-topics-caller-context-caller-origin③">caller origin</a> as input.</p>
         </ol>
        <li data-md>
         <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①">Queue a global task</a> on the <a data-link-type="dfn" href="#browsing-topics-task-source" id="ref-for-browsing-topics-task-source">browsing topics task source</a> given <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a> to perform the following steps:</p>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve">Resolve</a> <var>promise</var> with <var>topics</var>.</p>
         </ol>
       </ol>
      <li data-md>
       <p>Return <var>promise</var>.</p>
     </ol>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="13" id="handle-topics-fetch-request-header"><span class="secno">13. </span><span class="content">Handle fetch(&lt;url>, {browsingTopics: true}) and &lt;iframe src=url browsingtopics>&lt;/></span><a class="self-link" href="#handle-topics-fetch-request-header"></a></h2>
     Topics can be sent in the HTTP header for <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-global-fetch" id="ref-for-dom-global-fetch①">fetch()</a></code> requests and for <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#navigate-an-iframe-or-frame">iframe navigation</a> requests. The response header for a topics related request can specify whether the caller should to be recorded. 
    <h3 class="heading settled" data-level="13.1" id="send-browsing-topics-header-boolean-associated-with-request-header"><span class="secno">13.1. </span><span class="content">send browsing topics header boolean associated with Request</span><a class="self-link" href="#send-browsing-topics-header-boolean-associated-with-request-header"></a></h3>
     A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> has an associated <dfn class="dfn-paneled" data-dfn-for="request" data-dfn-type="dfn" data-noexport id="request-send-browsing-topics-header-boolean">send browsing topics header boolean</dfn>. Unless stated otherwise it is unset. 
    <p><span class="XXX">TODO: make the modification directly to the fetch spec.</span></p>
    <h3 class="heading settled" data-level="13.2" id="browsing-topics-content-attribute-for-iframe-element-header"><span class="secno">13.2. </span><span class="content">browsingtopics content attribute for HTMLIframeElement</span><a class="self-link" href="#browsing-topics-content-attribute-for-iframe-element-header"></a></h3>
     The <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-baf95ce8d0404079723db392663d355e">iframe</a> element contains a <dfn class="dfn-paneled" data-dfn-for="iframe" data-dfn-type="element-attr" data-export id="element-attrdef-iframe-browsingtopics"><code>browsingtopics</code></dfn> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes">content attribute</a>. The IDL attribute <dfn class="dfn-paneled idl-code" data-dfn-for="HTMLIFrameElement" data-dfn-type="attribute" data-export id="dom-htmliframeelement-browsingtopics"><code>browsingTopics</code></dfn> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect" id="ref-for-reflect">reflects</a> the <code><a data-link-type="element-sub" href="#element-attrdef-iframe-browsingtopics" id="ref-for-element-attrdef-iframe-browsingtopics">browsingtopics</a></code> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes①">content attribute</a>. 
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement" id="ref-for-htmliframeelement"><c- g>HTMLIFrameElement</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-type="boolean" href="#dom-htmliframeelement-browsingtopics" id="ref-for-dom-htmliframeelement-browsingtopics"><c- g>browsingTopics</c-></a>;
};
</pre>
    <p><span class="XXX">TODO: make the modification directly to the html spec.</span></p>
    <h3 class="heading settled" data-level="13.3" id="browsing-topics-attribute-in-request-init-header"><span class="secno">13.3. </span><span class="content">browsingTopics attribute in RequestInit</span><a class="self-link" href="#browsing-topics-attribute-in-request-init-header"></a></h3>
     The <a href="https://fetch.spec.whatwg.org/#requestinit">RequestInit</a> dictionary contains a browsingTopics attribute: 
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="idl-code" data-dfn-type="dictionary" data-export id="dictdef-requestinit"><code><c- g>RequestInit</c-></code><a class="self-link" href="#dictdef-requestinit"></a></dfn> {
  // existing attributes ...

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RequestInit" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-requestinit-browsingtopics"><code><c- g>browsingTopics</c-></code></dfn>;
};
</pre>
    <p><span class="XXX">TODO: make the modification directly to the fetch spec.</span></p>
    <h3 class="heading settled" data-level="13.4" id="modification-to-request-constructor-steps-header"><span class="secno">13.4. </span><span class="content">Modification to request constructor steps</span><a class="self-link" href="#modification-to-request-constructor-steps-header"></a></h3>
     The following step will be added to the <a href="https://fetch.spec.whatwg.org/#dom-request">new Request(input, init) constructor steps</a>, before step "Set this’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request">request</a> to <var>request</var>": 
    <ol>
     <li data-md>
      <p>If <var>init</var>["<code class="idl"><a data-link-type="idl" href="#dom-requestinit-browsingtopics" id="ref-for-dom-requestinit-browsingtopics">browsingTopics</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a>, then set <var>request</var>’s <a data-link-type="dfn" href="#request-send-browsing-topics-header-boolean" id="ref-for-request-send-browsing-topics-header-boolean">send browsing topics header boolean</a> to it.</p>
    </ol>
    <p><span class="XXX">TODO: make the modification directly to the fetch spec.</span></p>
    <h3 class="heading settled" data-level="13.5" id="modification-to-create-navigation-params-by-fetching-steps-header"><span class="secno">13.5. </span><span class="content">Modification to "create navigation params by fetching" steps</span><a class="self-link" href="#modification-to-create-navigation-params-by-fetching-steps-header"></a></h3>
     The following step will be added to the <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#create-navigation-params-by-fetching">create navigation params by fetching steps</a>, after step "Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-request" id="ref-for-concept-request-request①">request</a>, with ...": 
    <ol>
     <li data-md>
      <p>If <var>navigable</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container" id="ref-for-nav-container">container</a> is an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code> element, and if it has a <code><a data-link-type="element-sub" href="#element-attrdef-iframe-browsingtopics" id="ref-for-element-attrdef-iframe-browsingtopics①">browsingtopics</a></code> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes" id="ref-for-concept-element-attributes②">content attribute</a>, then set <var>request</var>’s <a data-link-type="dfn" href="#request-send-browsing-topics-header-boolean" id="ref-for-request-send-browsing-topics-header-boolean①">send browsing topics header boolean</a> to true.</p>
    </ol>
    <p><span class="XXX">TODO: make the modification directly to the html spec.</span></p>
    <h3 class="heading settled" data-level="13.6" id="the-sec-browsing-topics-http-request-header-header"><span class="secno">13.6. </span><span class="content">The `<code>Sec-Browsing-Topics</code>` HTTP request header</span><a class="self-link" href="#the-sec-browsing-topics-http-request-header-header"></a></h3>
    <p>This specification defines a `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="http-headerdef-sec-browsing-topics"><code>Sec-Browsing-Topics</code></dfn>` HTTP request header. It is used to send the topics.</p>
    <h3 class="heading settled" data-level="13.7" id="modification-to-http-network-or-cache-fetch-algorithm-header"><span class="secno">13.7. </span><span class="content">Modification to HTTP-network-or-cache fetch algorithm</span><a class="self-link" href="#modification-to-http-network-or-cache-fetch-algorithm-header"></a></h3>
     The following step will be added to the <a href="https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch">HTTP-network-or-cache fetch</a> algorithm, before step "Modify <var>httpRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list">header list</a> per HTTP. ...": 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#append-or-modify-a-request-sec-browsing-topics-header" id="ref-for-append-or-modify-a-request-sec-browsing-topics-header">Append or modify a request `<code>Sec-Browsing-Topics</code>` header</a> for <var>httpRequest</var>.</p>
    </ol>
    <p><span class="XXX">TODO: make the modification directly to the fetch spec.</span></p>
    <h3 class="heading settled" data-level="13.8" id="append-or-modify-a-request-sec-browsing-topics-header-header"><span class="secno">13.8. </span><span class="content">Append or modify a request <code>Sec-Browsing-Topics</code> header</span><a class="self-link" href="#append-or-modify-a-request-sec-browsing-topics-header-header"></a></h3>
    <div class="algorithm" data-algorithm="append or modify a request `Sec-Browsing-Topics` header">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="append-or-modify-a-request-sec-browsing-topics-header">append or modify a request `<code>Sec-Browsing-Topics</code>` header</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a> <var>request</var>, run these steps: 
     <ol>
      <li data-md>
       <p>If <var>request</var>’s <a data-link-type="dfn" href="#request-send-browsing-topics-header-boolean" id="ref-for-request-send-browsing-topics-header-boolean②">send browsing topics header boolean</a> is not true, then return.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-delete" id="ref-for-concept-header-list-delete">Delete</a> <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-browsing-topics" id="ref-for-http-headerdef-sec-browsing-topics①">Sec-Browsing-Topics</a></code>`</span> from <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a>.</p>
       <p class="note" role="note"> The topics a request is allowed to see can change within its redirect chain. For example, different caller origins may receive different topics, as the callers can only get the topics about the sites they were on. Besides, regardless of cross-origin-ness, the timestamp can also affect the candidate epochs where the topics are derived from, thus resulting in different topics across redirects. </p>
      <li data-md>
       <p>Let <var>initiatorWindow</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window">window</a>.</p>
      <li data-md>
       <p>Let <var>requestOrigin</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin④">origin</a>.</p>
      <li data-md>
       <p>If <var>requestOrigin</var> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin">potentially trustworthy origin</a>, then return.</p>
      <li data-md>
       <p>If <var>initiatorWindow</var> is not an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a>, then return.</p>
      <li data-md>
       <p>If <var>initiatorWindow</var> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①">secure context</a>, then return.</p>
      <li data-md>
       <p>For each feature <var>f</var> in « "<code>browsing-topic</code>", "<code>interest-cohort</code>" »:</p>
       <ol>
        <li data-md>
         <p>Run the <a href="https://www.w3.org/TR/permissions-policy-1/#algo-should-request-be-allowed-to-use-feature">Should request be allowed to use feature?</a> algorithm with <var>feature</var> set to <var>f</var> and <var>request</var> set to <var>request</var>. If the algorithm returns false, then return.</p>
       </ol>
       <p class="note" role="note"><span class="marker">Note:</span> the above algorithm should include the <a href="https://github.com/w3c/webappsec-permissions-policy/pull/499">pending update</a>, i.e. the <var>request</var> should be considered to contain the equivalent opt-in flags for both "browsing-topic" and the "interest-cohort" feature.</p>
      <li data-md>
       <p>Let <var>topicsCallerContext</var> be a <a data-link-type="dfn" href="#browsing-topics-types-topics-caller-context" id="ref-for-browsing-topics-types-topics-caller-context③">topics caller context</a> with default initial field values.</p>
      <li data-md>
       <p>Set <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-caller-origin" id="ref-for-topics-caller-context-caller-origin④">caller origin</a> to <var>requestOrigin</var>.</p>
      <li data-md>
       <p>Set <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain⑥">top level context domain</a> to the result of running <var>initiatorWindow</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-navigable" id="ref-for-window-navigable">navigable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top①">top-level traversable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document" id="ref-for-nav-document①">active document</a>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/browsers.html#dom-document-domain" id="ref-for-dom-document-domain①">domain</a></code> getter steps.</p>
      <li data-md>
       <p>Let <var>unsafeMoment</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock⑧">wall clock</a>'s <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0" id="ref-for-dfn-unsafe-current-time-0④">unsafe current time</a>.</p>
      <li data-md>
       <p>Let <var>moment</var> be the result of running <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-coarsen-time" id="ref-for-dfn-coarsen-time④">coarsen time</a> algorithm given <var>unsafeMoment</var> and <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-wall-clock" id="ref-for-dfn-wall-clock⑨">wall clock</a> as input.</p>
      <li data-md>
       <p>Let <var>fromUnixEpochTime</var> be the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-duration-from" id="ref-for-dfn-duration-from④">duration from</a> the <a data-link-type="dfn" href="https://w3c.github.io/hr-time/#dfn-unix-epoch" id="ref-for-dfn-unix-epoch⑦">Unix epoch</a> to <var>moment</var>.</p>
      <li data-md>
       <p>Set <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-timestamp" id="ref-for-topics-caller-context-timestamp②">timestamp</a> to <var>fromUnixEpochTime</var>.</p>
      <li data-md>
       <p>If the user preference setting disallows the access to topics from <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-caller-origin" id="ref-for-topics-caller-context-caller-origin⑤">caller origin</a> or <var>topicsCallerContext</var>’s <a data-link-type="dfn" href="#topics-caller-context-top-level-context-domain" id="ref-for-topics-caller-context-top-level-context-domain⑦">top level context domain</a>, then return.</p>
      <li data-md>
       <p>Let <var>topics</var> be the result from running the <a data-link-type="dfn" href="#calculate-the-topics-for-caller" id="ref-for-calculate-the-topics-for-caller①">calculate the topics for caller</a> algorithm, with <var>topicsCallerContext</var> as input.</p>
      <li data-md>
       <p>Let <var>headerStructuredFields</var> be an empty Structured Fields <a href="https://www.rfc-editor.org/rfc/rfc8941.html#name-lists">List</a>.</p>
      <li data-md>
       <p>For each <var>topic</var> in <var>topics</var>:</p>
       <ol>
        <li data-md>
         <p>Let <var>topicItem</var> be a Structured Fields <a href="https://www.rfc-editor.org/rfc/rfc8941.html#name-integers">Integer</a> with value <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-topic" id="ref-for-dom-browsingtopic-topic⑤">topic</a></code>"].</p>
        <li data-md>
         <p>Let <var>topicParameters</var> be an empty Structured Fields <a href="https://www.rfc-editor.org/rfc/rfc8941.html#name-parameters">Parameters</a>.</p>
        <li data-md>
         <p>Set <var>topicParameters</var>["<code>version</code>"] to <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-version" id="ref-for-dom-browsingtopic-version③">version</a></code>"].</p>
        <li data-md>
         <p>Set <var>topicParameters</var>["<code>config_version</code>"] to <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-configversion" id="ref-for-dom-browsingtopic-configversion②">configVersion</a></code>"].</p>
        <li data-md>
         <p>Set <var>topicParameters</var>["<code>model_version</code>"] to <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-modelversion" id="ref-for-dom-browsingtopic-modelversion②">modelVersion</a></code>"].</p>
        <li data-md>
         <p>Set <var>topicParameters</var>["<code>taxonomy_version</code>"] to <var>topic</var>["<code class="idl"><a data-link-type="idl" href="#dom-browsingtopic-taxonomyversion" id="ref-for-dom-browsingtopic-taxonomyversion②">taxonomyVersion</a></code>"].</p>
        <li data-md>
         <p>Associate <var>topicParameters</var> with <var>topicItem</var>.</p>
        <li data-md>
         <p>Insert <var>topicItem</var> to <var>headerStructuredFields</var>.</p>
       </ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set-structured-header" id="ref-for-concept-header-list-set-structured-header">Set a structured field value</a> given (<span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-browsing-topics" id="ref-for-http-headerdef-sec-browsing-topics②">Sec-Browsing-Topics</a></code>`</span>, <var>headerStructuredFields</var>) in <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list①">header list</a>.</p>
     </ol>
     <p class="note" role="note"><span class="marker">Note:</span> In Chrome’s experimentation phase, it will additionally require a valid <a href="https://github.com/GoogleChrome/OriginTrials/blob/gh-pages/explainer.md">Origin Trial</a> token to exist in <var>initiatorWindow</var>’s <a data-cite="!HTML#concept-document-window" data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window">associated document</a> for the request to be eligible for topics.</p>
    </div>
    <h3 class="heading settled" data-level="13.9" id="the-observe-browsing-topics-http-response-header-header"><span class="secno">13.9. </span><span class="content">The `<code>Observe-Browsing-Topics</code>` HTTP response header</span><a class="self-link" href="#the-observe-browsing-topics-http-response-header-header"></a></h3>
    <p>The `<dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="http-headerdef-observe-browsing-topics"><code>Observe-Browsing-Topics</code></dfn>` HTTP response header can be used to record a caller’s topics observation.</p>
    <div class="algorithm" data-algorithm="handle topics response">
      To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-topics-response">handle topics response</dfn>, given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-response" id="ref-for-concept-response-response">response</a> <var>response</var> and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a> request: 
     <ol>
      <li data-md>
       <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list②">header list</a> does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contain</a> <span>`<code><a data-link-type="http-header" href="#http-headerdef-sec-browsing-topics" id="ref-for-http-headerdef-sec-browsing-topics③">Sec-Browsing-Topics</a></code>`</span> (implying the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url">current URL</a> is not eligible for topics), then return.</p>
      <li data-md>
       <p>Let <var>topLevelDocument</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window①">window</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①">global object</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-navigable" id="ref-for-window-navigable①">navigable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top" id="ref-for-nav-top②">top-level traversable</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document" id="ref-for-nav-document②">active document</a>.</p>
      <li data-md>
       <p>Let <var>callerOrigin</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①">current URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑤">origin</a>.</p>
      <li data-md>
       <p>Let <var>list</var> be <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>.</p>
      <li data-md>
       <p>Let <var>headerValues</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get" id="ref-for-concept-header-list-get">getting</a> <span>`<code><a data-link-type="http-header" href="#http-headerdef-observe-browsing-topics" id="ref-for-http-headerdef-observe-browsing-topics">Observe-Browsing-Topics</a></code>`</span> from <var>list</var>.</p>
      <li data-md>
       <p>If <var>headerValues</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size③">size</a> is not 1, then return.</p>
      <li data-md>
       <p>Let <var>headerValue</var> be <var>headerValues</var>[0].</p>
      <li data-md>
       <p>Let <var>observe</var> be the result of <a href="https://www.rfc-editor.org/rfc/rfc8941.html#name-parsing-a-boolean">parsing</a> <var>headerValue</var> into Structured Fields <a href="https://www.rfc-editor.org/rfc/rfc8941.html#name-booleans">Boolean</a>.</p>
      <li data-md>
       <p>If <var>observe</var> is true:</p>
       <ol>
        <li data-md>
         <p>Run the <a data-link-type="dfn" href="#collect-page-topics-calculation-input-data" id="ref-for-collect-page-topics-calculation-input-data①">collect page topics calculation input data</a> algorithm with <var>topLevelDocument</var> as input.</p>
        <li data-md>
         <p>Run the <a data-link-type="dfn" href="#collect-topics-caller-origin" id="ref-for-collect-topics-caller-origin①">collect topics caller origin</a> algorithm with <var>topLevelDocument</var> and <var>callerOrigin</var> as input.</p>
       </ol>
     </ol>
    </div>
    <h3 class="heading settled" data-level="13.10" id="modification-to-http-fetch-steps-header"><span class="secno">13.10. </span><span class="content">Modification to HTTP fetch steps</span><a class="self-link" href="#modification-to-http-fetch-steps-header"></a></h3>
     The following step will be added to the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch">HTTP fetch</a> steps, before checking the redirect status (i.e. "If <var>actualResponse</var>’s status is a redirect status, ..."): 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#handle-topics-response" id="ref-for-handle-topics-response">Handle topics response</a>, given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-response" id="ref-for-concept-response-response①">response</a> <var>actualResponse</var> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">request</a> <var>request</var> as input.</p>
    </ol>
    <p><span class="XXX">TODO: make the modification directly to the fetch spec.</span></p>
   </section>
   <section>
    <h2 class="heading settled" data-level="14" id="permissions-policy-integration-header"><span class="secno">14. </span><span class="content">Permissions policy integration</span><a class="self-link" href="#permissions-policy-integration-header"></a></h2>
    <p>This specification defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature">policy-controlled feature</a> identified by the string
  "<code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="browsing-topics-policy-controlled-feature">browsing-topics</dfn></code>". Its <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist" id="ref-for-policy-controlled-feature-default-allowlist">default allowlist</a> is <code>*</code>. </p>
    <p>For backward compatibility, this specification also defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature①">policy-controlled feature</a> identified by the string
  "<code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interest-cohort-policy-controlled-feature">interest-cohort</dfn></code>". Its <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist" id="ref-for-policy-controlled-feature-default-allowlist①">default allowlist</a> is <code>*</code>. </p>
   </section>
   <section>
    <h2 class="heading settled" data-level="15" id="privacy-considerations-header"><span class="secno">15. </span><span class="content">Privacy considerations</span><a class="self-link" href="#privacy-considerations-header"></a></h2>
    <p>The Topics API attempts to provide just enough relevant interest information for advertisers to be able to personalize their ads for the user while maintaining user privacy. Some privacy safeguards include: usage in secure contexts only, topic limitation to a human curated taxonomy, different topics given to different sites in the same epoch to prevent cross-site reidentification, noised topics, a limited number of topics provided per epoch, user opt outs, site opt outs, and a suggestion that user agents provide UX to give users choice in which Topics are returned.</p>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#append-or-modify-a-request-sec-browsing-topics-header">append or modify a request `Sec-Browsing-Topics` header</a><span>, in § 13.8</span>
   <li><a href="#dictdef-browsingtopic">BrowsingTopic</a><span>, in § 4</span>
   <li><a href="#browsing-topics-policy-controlled-feature">browsing-topics</a><span>, in § 14</span>
   <li>
    browsingTopics
    <ul>
     <li><a href="#dom-htmliframeelement-browsingtopics">attribute for HTMLIFrameElement</a><span>, in § 13.2</span>
     <li><a href="#dom-requestinit-browsingtopics">dict-member for RequestInit</a><span>, in § 13.3</span>
    </ul>
   <li><a href="#element-attrdef-iframe-browsingtopics">browsingtopics</a><span>, in § 13.2</span>
   <li><a href="#dom-document-browsingtopics">browsingTopics()</a><span>, in § 12</span>
   <li><a href="#dom-document-browsingtopics">browsingTopics(options)</a><span>, in § 12</span>
   <li><a href="#dictdef-browsingtopicsoptions">BrowsingTopicsOptions</a><span>, in § 12</span>
   <li><a href="#browsing-topics-task-source">browsing topics task source</a><span>, in § 12</span>
   <li><a href="#calculate-the-epochs-for-caller">calculate the epochs for caller</a><span>, in § 10</span>
   <li><a href="#calculate-the-topics-for-caller">calculate the topics for caller</a><span>, in § 11</span>
   <li><a href="#calculate-user-topics">calculate user topics</a><span>, in § 9</span>
   <li><a href="#topics-caller-context-caller-origin">caller origin</a><span>, in § 2</span>
   <li><a href="#topic-with-caller-origins-caller-origins">caller origins</a><span>, in § 2</span>
   <li><a href="#classify">classify</a><span>, in § 2</span>
   <li><a href="#browsing-topics-dictionary-less-than-comparator">code unit less than</a><span>, in § 4</span>
   <li><a href="#collect-page-topics-calculation-input-data">collect page topics calculation input data</a><span>, in § 7</span>
   <li><a href="#collect-topics-caller-origin">collect topics caller origin</a><span>, in § 8</span>
   <li>
    configuration version
    <ul>
     <li><a href="#browsing-topics-types-configuration-version">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#user-agent-configuration-version">dfn for user agent</a><span>, in § 3</span>
    </ul>
   <li><a href="#epoch-config-version">config version</a><span>, in § 2</span>
   <li><a href="#dom-browsingtopic-configversion">configVersion</a><span>, in § 4</span>
   <li>
    document id
    <ul>
     <li><a href="#document-id-header-document-id">dfn for document-id-header</a><span>, in § 5</span>
     <li><a href="#topics-history-entry-document-id">dfn for topics history entry</a><span>, in § 2</span>
    </ul>
   <li><a href="#browsing-topics-types-epoch">epoch</a><span>, in § 2</span>
   <li><a href="#user-topics-state-epochs">epochs</a><span>, in § 2</span>
   <li><a href="#get-descendant-topics">get descendant topics</a><span>, in § 2</span>
   <li><a href="#handle-topics-response">handle topics response</a><span>, in § 13.9</span>
   <li><a href="#user-topics-state-hmac-key">hmac key</a><span>, in § 2</span>
   <li><a href="#interest-cohort-policy-controlled-feature">interest-cohort</a><span>, in § 14</span>
   <li>
    model
    <ul>
     <li><a href="#browsing-topics-types-model">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#user-agent-model">dfn for user agent</a><span>, in § 3</span>
    </ul>
   <li>
    model version
    <ul>
     <li><a href="#browsing-topics-types-model-version">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#epoch-model-version">dfn for epoch</a><span>, in § 2</span>
     <li><a href="#user-agent-model-version">dfn for user agent</a><span>, in § 3</span>
    </ul>
   <li><a href="#dom-browsingtopic-modelversion">modelVersion</a><span>, in § 4</span>
   <li><a href="#http-headerdef-observe-browsing-topics">Observe-Browsing-Topics</a><span>, in § 13.9</span>
   <li><a href="#dictdef-requestinit">RequestInit</a><span>, in § 13.3</span>
   <li><a href="#schedule-user-topics-calculation">schedule user topics calculation</a><span>, in § 9</span>
   <li><a href="#http-headerdef-sec-browsing-topics">Sec-Browsing-Topics</a><span>, in § 13.6</span>
   <li><a href="#request-send-browsing-topics-header-boolean">send browsing topics header boolean</a><span>, in § 13.1</span>
   <li><a href="#dom-browsingtopicsoptions-skipobservation">skipObservation</a><span>, in § 12</span>
   <li>
    taxonomy
    <ul>
     <li><a href="#browsing-topics-types-taxonomy">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#epoch-taxonomy">dfn for epoch</a><span>, in § 2</span>
     <li><a href="#user-agent-taxonomy">dfn for user agent</a><span>, in § 3</span>
    </ul>
   <li>
    taxonomy version
    <ul>
     <li><a href="#browsing-topics-types-taxonomy-version">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#epoch-taxonomy-version">dfn for epoch</a><span>, in § 2</span>
     <li><a href="#user-agent-taxonomy-version">dfn for user agent</a><span>, in § 3</span>
    </ul>
   <li><a href="#dom-browsingtopic-taxonomyversion">taxonomyVersion</a><span>, in § 4</span>
   <li>
    time
    <ul>
     <li><a href="#epoch-time">dfn for epoch</a><span>, in § 2</span>
     <li><a href="#topics-history-entry-time">dfn for topics history entry</a><span>, in § 2</span>
    </ul>
   <li><a href="#topics-caller-context-timestamp">timestamp</a><span>, in § 2</span>
   <li><a href="#epoch-top-5-topics-with-caller-origins">top 5 topics with caller origins</a><span>, in § 2</span>
   <li><a href="#dom-browsingtopic-topic">topic</a><span>, in § 4</span>
   <li><a href="#topic-with-caller-origins-topic-id">topic id</a><span>, in § 2</span>
   <li><a href="#browsing-topics-types-topic-ids">topic ids</a><span>, in § 2</span>
   <li>
    topics calculation input data
    <ul>
     <li><a href="#determine-topics-calculation-input-data-header-topics-calculation-input-data">dfn for determine-topics-calculation-input-data-header</a><span>, in § 6</span>
     <li><a href="#topics-history-entry-topics-calculation-input-data">dfn for topics history entry</a><span>, in § 2</span>
    </ul>
   <li><a href="#browsing-topics-types-topics-caller-context">topics caller context</a><span>, in § 2</span>
   <li><a href="#topics-history-entry-topics-caller-origins">topics caller origins</a><span>, in § 2</span>
   <li><a href="#browsing-topics-types-topics-history-entry">topics history entry</a><span>, in § 2</span>
   <li><a href="#user-agent-topics-history-storage">topics history storage</a><span>, in § 3</span>
   <li><a href="#browsing-topics-types-topic-with-caller-origins">topic with caller origins</a><span>, in § 2</span>
   <li><a href="#topics-caller-context-top-level-context-domain">top level context domain</a><span>, in § 2</span>
   <li>
    user topics state
    <ul>
     <li><a href="#browsing-topics-types-user-topics-state">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#user-agent-user-topics-state">dfn for user agent</a><span>, in § 3</span>
    </ul>
   <li>
    version
    <ul>
     <li><a href="#browsing-topics-types-version">dfn for browsing topics types</a><span>, in § 2</span>
     <li><a href="#dom-browsingtopic-version">dict-member for BrowsingTopic</a><span>, in § 4</span>
    </ul>
  </ul>
  <aside aria-labelledby="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" class="dfn-panel" data-for="07886e33695d0e7b473ef18f656ad7ac" id="infopanel-for-07886e33695d0e7b473ef18f656ad7ac">
   <span id="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" style="display:none">Info about the 'Document' external reference.</span><a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">5. document ID</a> <a href="#ref-for-document①">(2)</a>
    <li><a href="#ref-for-document②">6. Determine topics calculation input data</a> <a href="#ref-for-document③">(2)</a>
    <li><a href="#ref-for-document④">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-document⑤">8. Collect topics caller origin</a>
    <li><a href="#ref-for-document⑥">12. The JavaScript API</a> <a href="#ref-for-document⑦">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0a24705db1888449eefd8934eabb5d51" class="dfn-panel" data-for="0a24705db1888449eefd8934eabb5d51" id="infopanel-for-0a24705db1888449eefd8934eabb5d51">
   <span id="infopaneltitle-for-0a24705db1888449eefd8934eabb5d51" style="display:none">Info about the 'descendant text content' external reference.</span><a href="https://dom.spec.whatwg.org/#concept-descendant-text-content">https://dom.spec.whatwg.org/#concept-descendant-text-content</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-descendant-text-content">6. Determine topics calculation input data</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9c5cdbb5c3dd225a70ea0af45a02c608" class="dfn-panel" data-for="9c5cdbb5c3dd225a70ea0af45a02c608" id="infopanel-for-9c5cdbb5c3dd225a70ea0af45a02c608">
   <span id="infopaneltitle-for-9c5cdbb5c3dd225a70ea0af45a02c608" style="display:none">Info about the 'origin' external reference.</span><a href="https://dom.spec.whatwg.org/#concept-document-origin">https://dom.spec.whatwg.org/#concept-document-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-origin">12. The JavaScript API</a> <a href="#ref-for-concept-document-origin①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-2fc74f43c6d7f15a4a2fbfbece346388" class="dfn-panel" data-for="2fc74f43c6d7f15a4a2fbfbece346388" id="infopanel-for-2fc74f43c6d7f15a4a2fbfbece346388">
   <span id="infopaneltitle-for-2fc74f43c6d7f15a4a2fbfbece346388" style="display:none">Info about the 'url' external reference.</span><a href="https://dom.spec.whatwg.org/#concept-document-url">https://dom.spec.whatwg.org/#concept-document-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-url">6. Determine topics calculation input data</a> <a href="#ref-for-concept-document-url①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f82af8baf203f1b0578ed1442dd2d24b" class="dfn-panel" data-for="f82af8baf203f1b0578ed1442dd2d24b" id="infopanel-for-f82af8baf203f1b0578ed1442dd2d24b">
   <span id="infopaneltitle-for-f82af8baf203f1b0578ed1442dd2d24b" style="display:none">Info about the 'current url' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-request-current-url">https://fetch.spec.whatwg.org/#concept-request-current-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-current-url">13.9. The `Observe-Browsing-Topics` HTTP response header</a> <a href="#ref-for-concept-request-current-url①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fdb6c106dead7169eccfe54e56cec6bd" class="dfn-panel" data-for="fdb6c106dead7169eccfe54e56cec6bd" id="infopanel-for-fdb6c106dead7169eccfe54e56cec6bd">
   <span id="infopaneltitle-for-fdb6c106dead7169eccfe54e56cec6bd" style="display:none">Info about the 'delete' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-header-list-delete">https://fetch.spec.whatwg.org/#concept-header-list-delete</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header-list-delete">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6bab4bd07fdabe23531455ff4eabbda0" class="dfn-panel" data-for="6bab4bd07fdabe23531455ff4eabbda0" id="infopanel-for-6bab4bd07fdabe23531455ff4eabbda0">
   <span id="infopaneltitle-for-6bab4bd07fdabe23531455ff4eabbda0" style="display:none">Info about the 'fetch(input)' external reference.</span><a href="https://fetch.spec.whatwg.org/#dom-global-fetch">https://fetch.spec.whatwg.org/#dom-global-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-global-fetch">1. Introduction</a>
    <li><a href="#ref-for-dom-global-fetch①">13. Handle fetch(&lt;url>, {browsingTopics: true}) and &lt;iframe src=url browsingtopics>&lt;/></a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6ef0be99a5b17cb515c6816ad5548e89" class="dfn-panel" data-for="6ef0be99a5b17cb515c6816ad5548e89" id="infopanel-for-6ef0be99a5b17cb515c6816ad5548e89">
   <span id="infopaneltitle-for-6ef0be99a5b17cb515c6816ad5548e89" style="display:none">Info about the 'get' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-header-list-get">https://fetch.spec.whatwg.org/#concept-header-list-get</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header-list-get">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5171067c910207c96b5420a19bae87a3" class="dfn-panel" data-for="5171067c910207c96b5420a19bae87a3" id="infopanel-for-5171067c910207c96b5420a19bae87a3">
   <span id="infopaneltitle-for-5171067c910207c96b5420a19bae87a3" style="display:none">Info about the 'header list' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-header-list">https://fetch.spec.whatwg.org/#concept-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header-list">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-4fd8d1762cd9c874700296c854598fda" class="dfn-panel" data-for="4fd8d1762cd9c874700296c854598fda" id="infopanel-for-4fd8d1762cd9c874700296c854598fda">
   <span id="infopaneltitle-for-4fd8d1762cd9c874700296c854598fda" style="display:none">Info about the 'header list (for request)' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-request-header-list">https://fetch.spec.whatwg.org/#concept-request-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-header-list">13.7. Modification to HTTP-network-or-cache fetch algorithm</a>
    <li><a href="#ref-for-concept-request-header-list①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-concept-request-header-list②">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d94cb5e6252c9158478ebbe8a624e99c" class="dfn-panel" data-for="d94cb5e6252c9158478ebbe8a624e99c" id="infopanel-for-d94cb5e6252c9158478ebbe8a624e99c">
   <span id="infopaneltitle-for-d94cb5e6252c9158478ebbe8a624e99c" style="display:none">Info about the 'header list (for response)' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">https://fetch.spec.whatwg.org/#concept-response-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-response-header-list">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e094c825ead002ca7d4383f2aba777f9" class="dfn-panel" data-for="e094c825ead002ca7d4383f2aba777f9" id="infopanel-for-e094c825ead002ca7d4383f2aba777f9">
   <span id="infopaneltitle-for-e094c825ead002ca7d4383f2aba777f9" style="display:none">Info about the 'http fetch' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-http-fetch">https://fetch.spec.whatwg.org/#concept-http-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-http-fetch">13.10. Modification to HTTP fetch steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-491791562dd138987138e7051a96c07c" class="dfn-panel" data-for="491791562dd138987138e7051a96c07c" id="infopanel-for-491791562dd138987138e7051a96c07c">
   <span id="infopaneltitle-for-491791562dd138987138e7051a96c07c" style="display:none">Info about the 'request' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-request">https://fetch.spec.whatwg.org/#concept-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request">13.1. send browsing topics header boolean associated with Request</a>
    <li><a href="#ref-for-concept-request①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-concept-request②">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
    <li><a href="#ref-for-concept-request③">13.10. Modification to HTTP fetch steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-62eb8611855ca0d3551225567f68307a" class="dfn-panel" data-for="62eb8611855ca0d3551225567f68307a" id="infopanel-for-62eb8611855ca0d3551225567f68307a">
   <span id="infopaneltitle-for-62eb8611855ca0d3551225567f68307a" style="display:none">Info about the 'request (for Request)' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-request-request">https://fetch.spec.whatwg.org/#concept-request-request</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-request">13.4. Modification to request constructor steps</a>
    <li><a href="#ref-for-concept-request-request①">13.5. Modification to "create navigation params by fetching" steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-12a5f639c62d2f0bd5e5e8ab36848416" class="dfn-panel" data-for="12a5f639c62d2f0bd5e5e8ab36848416" id="infopanel-for-12a5f639c62d2f0bd5e5e8ab36848416">
   <span id="infopaneltitle-for-12a5f639c62d2f0bd5e5e8ab36848416" style="display:none">Info about the 'response' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-response-response">https://fetch.spec.whatwg.org/#concept-response-response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-response-response">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
    <li><a href="#ref-for-concept-response-response①">13.10. Modification to HTTP fetch steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a50d6de302855c18285652c8be59e5b0" class="dfn-panel" data-for="a50d6de302855c18285652c8be59e5b0" id="infopanel-for-a50d6de302855c18285652c8be59e5b0">
   <span id="infopaneltitle-for-a50d6de302855c18285652c8be59e5b0" style="display:none">Info about the 'set a structured field value' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-header-list-set-structured-header">https://fetch.spec.whatwg.org/#concept-header-list-set-structured-header</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header-list-set-structured-header">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6f4775873c70787775f9c70f0f110709" class="dfn-panel" data-for="6f4775873c70787775f9c70f0f110709" id="infopanel-for-6f4775873c70787775f9c70f0f110709">
   <span id="infopaneltitle-for-6f4775873c70787775f9c70f0f110709" style="display:none">Info about the 'url' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-request-url">https://fetch.spec.whatwg.org/#concept-request-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-url">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d72233a2731c7f5b88c9c3da9700b26a" class="dfn-panel" data-for="d72233a2731c7f5b88c9c3da9700b26a" id="infopanel-for-d72233a2731c7f5b88c9c3da9700b26a">
   <span id="infopaneltitle-for-d72233a2731c7f5b88c9c3da9700b26a" style="display:none">Info about the 'window' external reference.</span><a href="https://fetch.spec.whatwg.org/#concept-request-window">https://fetch.spec.whatwg.org/#concept-request-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-window">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-concept-request-window①">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0527034ee7070fda15ffa50c34dbbc63" class="dfn-panel" data-for="0527034ee7070fda15ffa50c34dbbc63" id="infopanel-for-0527034ee7070fda15ffa50c34dbbc63">
   <span id="infopaneltitle-for-0527034ee7070fda15ffa50c34dbbc63" style="display:none">Info about the 'DOMHighResTimeStamp' external reference.</span><a href="https://w3c.github.io/hr-time/#dom-domhighrestimestamp">https://w3c.github.io/hr-time/#dom-domhighrestimestamp</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-domhighrestimestamp">2. Terminology and types</a> <a href="#ref-for-dom-domhighrestimestamp①">(2)</a> <a href="#ref-for-dom-domhighrestimestamp②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c626b66893b5c29e4adba851077ed0e2" class="dfn-panel" data-for="c626b66893b5c29e4adba851077ed0e2" id="infopanel-for-c626b66893b5c29e4adba851077ed0e2">
   <span id="infopaneltitle-for-c626b66893b5c29e4adba851077ed0e2" style="display:none">Info about the 'coarsen time' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-coarsen-time">https://w3c.github.io/hr-time/#dfn-coarsen-time</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-coarsen-time">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-dfn-coarsen-time①">9. Periodically calculate user topics</a> <a href="#ref-for-dfn-coarsen-time②">(2)</a>
    <li><a href="#ref-for-dfn-coarsen-time③">12. The JavaScript API</a>
    <li><a href="#ref-for-dfn-coarsen-time④">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9213a3aff5ff1021ab4c2d780aa70cee" class="dfn-panel" data-for="9213a3aff5ff1021ab4c2d780aa70cee" id="infopanel-for-9213a3aff5ff1021ab4c2d780aa70cee">
   <span id="infopaneltitle-for-9213a3aff5ff1021ab4c2d780aa70cee" style="display:none">Info about the 'duration' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-duration">https://w3c.github.io/hr-time/#dfn-duration</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-duration">9. Periodically calculate user topics</a> <a href="#ref-for-dfn-duration①">(2)</a> <a href="#ref-for-dfn-duration②">(3)</a> <a href="#ref-for-dfn-duration③">(4)</a> <a href="#ref-for-dfn-duration④">(5)</a> <a href="#ref-for-dfn-duration⑤">(6)</a> <a href="#ref-for-dfn-duration⑥">(7)</a> <a href="#ref-for-dfn-duration⑦">(8)</a> <a href="#ref-for-dfn-duration⑧">(9)</a> <a href="#ref-for-dfn-duration⑨">(10)</a>
    <li><a href="#ref-for-dfn-duration①⓪">10. Epochs for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-73fffec128d2fef2b2301baf9dc7fa01" class="dfn-panel" data-for="73fffec128d2fef2b2301baf9dc7fa01" id="infopanel-for-73fffec128d2fef2b2301baf9dc7fa01">
   <span id="infopaneltitle-for-73fffec128d2fef2b2301baf9dc7fa01" style="display:none">Info about the 'duration from' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-duration-from">https://w3c.github.io/hr-time/#dfn-duration-from</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-duration-from">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-dfn-duration-from①">9. Periodically calculate user topics</a> <a href="#ref-for-dfn-duration-from②">(2)</a>
    <li><a href="#ref-for-dfn-duration-from③">12. The JavaScript API</a>
    <li><a href="#ref-for-dfn-duration-from④">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c6a6e18a0bfb0f6727343f416cd90c01" class="dfn-panel" data-for="c6a6e18a0bfb0f6727343f416cd90c01" id="infopanel-for-c6a6e18a0bfb0f6727343f416cd90c01">
   <span id="infopaneltitle-for-c6a6e18a0bfb0f6727343f416cd90c01" style="display:none">Info about the 'unix epoch' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-unix-epoch">https://w3c.github.io/hr-time/#dfn-unix-epoch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-unix-epoch">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-dfn-unix-epoch①">9. Periodically calculate user topics</a> <a href="#ref-for-dfn-unix-epoch②">(2)</a> <a href="#ref-for-dfn-unix-epoch③">(3)</a> <a href="#ref-for-dfn-unix-epoch④">(4)</a> <a href="#ref-for-dfn-unix-epoch⑤">(5)</a>
    <li><a href="#ref-for-dfn-unix-epoch⑥">12. The JavaScript API</a>
    <li><a href="#ref-for-dfn-unix-epoch⑦">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-5602165fe91a6a9a9ba8f7f873e44aef" class="dfn-panel" data-for="5602165fe91a6a9a9ba8f7f873e44aef" id="infopanel-for-5602165fe91a6a9a9ba8f7f873e44aef">
   <span id="infopaneltitle-for-5602165fe91a6a9a9ba8f7f873e44aef" style="display:none">Info about the 'unsafe current time' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0">https://w3c.github.io/hr-time/#dfn-unsafe-current-time-0</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-unsafe-current-time-0">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-dfn-unsafe-current-time-0①">9. Periodically calculate user topics</a> <a href="#ref-for-dfn-unsafe-current-time-0②">(2)</a>
    <li><a href="#ref-for-dfn-unsafe-current-time-0③">12. The JavaScript API</a>
    <li><a href="#ref-for-dfn-unsafe-current-time-0④">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9ce1d97c81991af84a4cfb8251a89c4e" class="dfn-panel" data-for="9ce1d97c81991af84a4cfb8251a89c4e" id="infopanel-for-9ce1d97c81991af84a4cfb8251a89c4e">
   <span id="infopaneltitle-for-9ce1d97c81991af84a4cfb8251a89c4e" style="display:none">Info about the 'wall clock' external reference.</span><a href="https://w3c.github.io/hr-time/#dfn-wall-clock">https://w3c.github.io/hr-time/#dfn-wall-clock</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-wall-clock">7. Collect page topics calculation input data</a> <a href="#ref-for-dfn-wall-clock①">(2)</a>
    <li><a href="#ref-for-dfn-wall-clock②">9. Periodically calculate user topics</a> <a href="#ref-for-dfn-wall-clock③">(2)</a> <a href="#ref-for-dfn-wall-clock④">(3)</a> <a href="#ref-for-dfn-wall-clock⑤">(4)</a>
    <li><a href="#ref-for-dfn-wall-clock⑥">12. The JavaScript API</a> <a href="#ref-for-dfn-wall-clock⑦">(2)</a>
    <li><a href="#ref-for-dfn-wall-clock⑧">13.8. Append or modify a request Sec-Browsing-Topics header</a> <a href="#ref-for-dfn-wall-clock⑨">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-62d5145a686fb21602c40aa7f2dc6dcb" class="dfn-panel" data-for="62d5145a686fb21602c40aa7f2dc6dcb" id="infopanel-for-62d5145a686fb21602c40aa7f2dc6dcb">
   <span id="infopaneltitle-for-62d5145a686fb21602c40aa7f2dc6dcb" style="display:none">Info about the 'CEReactions' external reference.</span><a href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cereactions">13.2. browsingtopics content attribute for HTMLIframeElement</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-75ff12c16ae1a8f6cbf2920128280261" class="dfn-panel" data-for="75ff12c16ae1a8f6cbf2920128280261" id="infopanel-for-75ff12c16ae1a8f6cbf2920128280261">
   <span id="infopaneltitle-for-75ff12c16ae1a8f6cbf2920128280261" style="display:none">Info about the 'HTMLIFrameElement' external reference.</span><a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmliframeelement">13.2. browsingtopics content attribute for HTMLIframeElement</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-de11cdc07a64c79878f1c3074e81554a" class="dfn-panel" data-for="de11cdc07a64c79878f1c3074e81554a" id="infopanel-for-de11cdc07a64c79878f1c3074e81554a">
   <span id="infopaneltitle-for-de11cdc07a64c79878f1c3074e81554a" style="display:none">Info about the 'active document' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document">https://html.spec.whatwg.org/multipage/document-sequences.html#nav-document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-nav-document">12. The JavaScript API</a>
    <li><a href="#ref-for-nav-document①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-nav-document②">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3dc9eee4a6a1d169f561b6d87bd08573" class="dfn-panel" data-for="3dc9eee4a6a1d169f561b6d87bd08573" id="infopanel-for-3dc9eee4a6a1d169f561b6d87bd08573">
   <span id="infopaneltitle-for-3dc9eee4a6a1d169f561b6d87bd08573" style="display:none">Info about the 'allowed to use' external reference.</span><a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-allowed-to-use">12. The JavaScript API</a> <a href="#ref-for-allowed-to-use①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-04e6c32034490f45e4757ead7871de18" class="dfn-panel" data-for="04e6c32034490f45e4757ead7871de18" id="infopanel-for-04e6c32034490f45e4757ead7871de18">
   <span id="infopaneltitle-for-04e6c32034490f45e4757ead7871de18" style="display:none">Info about the 'associated document' external reference.</span><a href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window">https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-window">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7e4a31202358e399f35eee7b9c479f4f" class="dfn-panel" data-for="7e4a31202358e399f35eee7b9c479f4f" id="infopanel-for-7e4a31202358e399f35eee7b9c479f4f">
   <span id="infopaneltitle-for-7e4a31202358e399f35eee7b9c479f4f" style="display:none">Info about the 'container' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container">https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-nav-container">13.5. Modification to "create navigation params by fetching" steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-56d977f87f79f0de3bb0c5ce53846293" class="dfn-panel" data-for="56d977f87f79f0de3bb0c5ce53846293" id="infopanel-for-56d977f87f79f0de3bb0c5ce53846293">
   <span id="infopaneltitle-for-56d977f87f79f0de3bb0c5ce53846293" style="display:none">Info about the 'content attributes' external reference.</span><a href="https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes">https://html.spec.whatwg.org/multipage/dom.html#concept-element-attributes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-element-attributes">13.2. browsingtopics content attribute for HTMLIframeElement</a> <a href="#ref-for-concept-element-attributes①">(2)</a>
    <li><a href="#ref-for-concept-element-attributes②">13.5. Modification to "create navigation params by fetching" steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3b597d41857f5e9275bb5cdecc55e21e" class="dfn-panel" data-for="3b597d41857f5e9275bb5cdecc55e21e" id="infopanel-for-3b597d41857f5e9275bb5cdecc55e21e">
   <span id="infopaneltitle-for-3b597d41857f5e9275bb5cdecc55e21e" style="display:none">Info about the 'domain' external reference.</span><a href="https://html.spec.whatwg.org/multipage/browsers.html#dom-document-domain">https://html.spec.whatwg.org/multipage/browsers.html#dom-document-domain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-document-domain">12. The JavaScript API</a>
    <li><a href="#ref-for-dom-document-domain①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d815dc723d8b4fe4b1166e2013ec62b7" class="dfn-panel" data-for="d815dc723d8b4fe4b1166e2013ec62b7" id="infopanel-for-d815dc723d8b4fe4b1166e2013ec62b7">
   <span id="infopaneltitle-for-d815dc723d8b4fe4b1166e2013ec62b7" style="display:none">Info about the 'environment settings object' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-environment-settings-object">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-53ea12fcca4eab4ccddd5da403fd6e4b" class="dfn-panel" data-for="53ea12fcca4eab4ccddd5da403fd6e4b" id="infopanel-for-53ea12fcca4eab4ccddd5da403fd6e4b">
   <span id="infopaneltitle-for-53ea12fcca4eab4ccddd5da403fd6e4b" style="display:none">Info about the 'global object' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-global">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-concept-settings-object-global①">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-346f0407b3fbc5b580ccfdf1597d8c07" class="dfn-panel" data-for="346f0407b3fbc5b580ccfdf1597d8c07" id="infopanel-for-346f0407b3fbc5b580ccfdf1597d8c07">
   <span id="infopaneltitle-for-346f0407b3fbc5b580ccfdf1597d8c07" style="display:none">Info about the 'hmac algorithm' external reference.</span><a href="https://www.rfc-editor.org/rfc/rfc6234#section-8.3">https://www.rfc-editor.org/rfc/rfc6234#section-8.3</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-section-8.3">10. Epochs for caller</a>
    <li><a href="#ref-for-section-8.3①">11. Topics for caller</a> <a href="#ref-for-section-8.3②">(2)</a> <a href="#ref-for-section-8.3③">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-baf95ce8d0404079723db392663d355e" class="dfn-panel" data-for="baf95ce8d0404079723db392663d355e" id="infopanel-for-baf95ce8d0404079723db392663d355e">
   <span id="infopaneltitle-for-baf95ce8d0404079723db392663d355e" style="display:none">Info about the 'iframe' external reference.</span><a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-baf95ce8d0404079723db392663d355e">13.2. browsingtopics content attribute for HTMLIframeElement</a>
    <li><a href="#ref-for-the-iframe-element">13.5. Modification to "create navigation params by fetching" steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3a2763fcaa6bc82693554cf36780c0dd" class="dfn-panel" data-for="3a2763fcaa6bc82693554cf36780c0dd" id="infopanel-for-3a2763fcaa6bc82693554cf36780c0dd">
   <span id="infopaneltitle-for-3a2763fcaa6bc82693554cf36780c0dd" style="display:none">Info about the 'in parallel' external reference.</span><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-in-parallel①">8. Collect topics caller origin</a>
    <li><a href="#ref-for-in-parallel②">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c65e32440cdd5af483d6b90189ff0d46" class="dfn-panel" data-for="c65e32440cdd5af483d6b90189ff0d46" id="infopanel-for-c65e32440cdd5af483d6b90189ff0d46">
   <span id="infopaneltitle-for-c65e32440cdd5af483d6b90189ff0d46" style="display:none">Info about the 'navigable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-navigable">https://html.spec.whatwg.org/multipage/nav-history-apis.html#window-navigable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window-navigable">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-window-navigable①">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d5ad1e20f67eb03bd0608119efdd55f5" class="dfn-panel" data-for="d5ad1e20f67eb03bd0608119efdd55f5" id="infopanel-for-d5ad1e20f67eb03bd0608119efdd55f5">
   <span id="infopaneltitle-for-d5ad1e20f67eb03bd0608119efdd55f5" style="display:none">Info about the 'node navigable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable">https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-node-navigable">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-node-navigable①">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-23307d34220e7159f8e5d8c231db141f" class="dfn-panel" data-for="23307d34220e7159f8e5d8c231db141f" id="infopanel-for-23307d34220e7159f8e5d8c231db141f">
   <span id="infopaneltitle-for-23307d34220e7159f8e5d8c231db141f" style="display:none">Info about the 'opaque origin' external reference.</span><a href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque">https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin-opaque">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-61b744463dec02bf7e3bb3e3aacce330" class="dfn-panel" data-for="61b744463dec02bf7e3bb3e3aacce330" id="infopanel-for-61b744463dec02bf7e3bb3e3aacce330">
   <span id="infopaneltitle-for-61b744463dec02bf7e3bb3e3aacce330" style="display:none">Info about the 'post-prerendering activation steps list' external reference.</span><a href="https://wicg.github.io/nav-speculation/prerendering.html#platform-object-post-prerendering-activation-steps-list">https://wicg.github.io/nav-speculation/prerendering.html#platform-object-post-prerendering-activation-steps-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-platform-object-post-prerendering-activation-steps-list">7. Collect page topics calculation input data</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dea49566381cb105c181f672af8cf41c" class="dfn-panel" data-for="dea49566381cb105c181f672af8cf41c" id="infopanel-for-dea49566381cb105c181f672af8cf41c">
   <span id="infopaneltitle-for-dea49566381cb105c181f672af8cf41c" style="display:none">Info about the 'prerendering navigable' external reference.</span><a href="https://wicg.github.io/nav-speculation/prerendering.html#prerendering-navigable">https://wicg.github.io/nav-speculation/prerendering.html#prerendering-navigable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-prerendering-navigable">7. Collect page topics calculation input data</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a8756513b792b8f203588906035a13bb" class="dfn-panel" data-for="a8756513b792b8f203588906035a13bb" id="infopanel-for-a8756513b792b8f203588906035a13bb">
   <span id="infopaneltitle-for-a8756513b792b8f203588906035a13bb" style="display:none">Info about the 'queue a global task' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-global-task">12. The JavaScript API</a> <a href="#ref-for-queue-a-global-task①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-b49dc0806d8dbf1a04db8e3ade97d3f3" class="dfn-panel" data-for="b49dc0806d8dbf1a04db8e3ade97d3f3" id="infopanel-for-b49dc0806d8dbf1a04db8e3ade97d3f3">
   <span id="infopaneltitle-for-b49dc0806d8dbf1a04db8e3ade97d3f3" style="display:none">Info about the 'reflect' external reference.</span><a href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect">https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflect</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reflect">13.2. browsingtopics content attribute for HTMLIframeElement</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-2233058c8f0998915af8393ee2abbc1d" class="dfn-panel" data-for="2233058c8f0998915af8393ee2abbc1d" id="infopanel-for-2233058c8f0998915af8393ee2abbc1d">
   <span id="infopaneltitle-for-2233058c8f0998915af8393ee2abbc1d" style="display:none">Info about the 'relevant global object' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">12. The JavaScript API</a> <a href="#ref-for-concept-relevant-global①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-613400696de3e8f8a5001430db03abe8" class="dfn-panel" data-for="613400696de3e8f8a5001430db03abe8" id="infopanel-for-613400696de3e8f8a5001430db03abe8">
   <span id="infopaneltitle-for-613400696de3e8f8a5001430db03abe8" style="display:none">Info about the 'secure context' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context">https://html.spec.whatwg.org/multipage/webappapis.html#secure-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-secure-context">12. The JavaScript API</a>
    <li><a href="#ref-for-secure-context①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bc7ee08574febf5b8b0e46ae2c167b82" class="dfn-panel" data-for="bc7ee08574febf5b8b0e46ae2c167b82" id="infopanel-for-bc7ee08574febf5b8b0e46ae2c167b82">
   <span id="infopaneltitle-for-bc7ee08574febf5b8b0e46ae2c167b82" style="display:none">Info about the 'top-level traversable' external reference.</span><a href="https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top">https://html.spec.whatwg.org/multipage/document-sequences.html#nav-top</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-nav-top">12. The JavaScript API</a>
    <li><a href="#ref-for-nav-top①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-nav-top②">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fcfc8b0ed220faa237969aed00e2586d" class="dfn-panel" data-for="fcfc8b0ed220faa237969aed00e2586d" id="infopanel-for-fcfc8b0ed220faa237969aed00e2586d">
   <span id="infopaneltitle-for-fcfc8b0ed220faa237969aed00e2586d" style="display:none">Info about the 'append (for list)' external reference.</span><a href="https://infra.spec.whatwg.org/#list-append">https://infra.spec.whatwg.org/#list-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-append">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-list-append①">9. Periodically calculate user topics</a> <a href="#ref-for-list-append②">(2)</a> <a href="#ref-for-list-append③">(3)</a> <a href="#ref-for-list-append④">(4)</a>
    <li><a href="#ref-for-list-append⑤">10. Epochs for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-53c2c70bc752d6cf2a1f7deddc029549" class="dfn-panel" data-for="53c2c70bc752d6cf2a1f7deddc029549" id="infopanel-for-53c2c70bc752d6cf2a1f7deddc029549">
   <span id="infopaneltitle-for-53c2c70bc752d6cf2a1f7deddc029549" style="display:none">Info about the 'append (for set)' external reference.</span><a href="https://infra.spec.whatwg.org/#set-append">https://infra.spec.whatwg.org/#set-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-append">8. Collect topics caller origin</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6e2a0a09507290bb1cc50a58f5bbde89" class="dfn-panel" data-for="6e2a0a09507290bb1cc50a58f5bbde89" id="infopanel-for-6e2a0a09507290bb1cc50a58f5bbde89">
   <span id="infopaneltitle-for-6e2a0a09507290bb1cc50a58f5bbde89" style="display:none">Info about the 'code unit less than' external reference.</span><a href="https://infra.spec.whatwg.org/#code-unit-less-than">https://infra.spec.whatwg.org/#code-unit-less-than</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-code-unit-less-than">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7605aa4703a0a6921736ddd5321cfc07" class="dfn-panel" data-for="7605aa4703a0a6921736ddd5321cfc07" id="infopanel-for-7605aa4703a0a6921736ddd5321cfc07">
   <span id="infopaneltitle-for-7605aa4703a0a6921736ddd5321cfc07" style="display:none">Info about the 'concatenate' external reference.</span><a href="https://infra.spec.whatwg.org/#string-concatenate">https://infra.spec.whatwg.org/#string-concatenate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-concatenate">2. Terminology and types</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-eb75379b05abc264a531a791358e1eba" class="dfn-panel" data-for="eb75379b05abc264a531a791358e1eba" id="infopanel-for-eb75379b05abc264a531a791358e1eba">
   <span id="infopaneltitle-for-eb75379b05abc264a531a791358e1eba" style="display:none">Info about the 'contain' external reference.</span><a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0d3ee326a162c16997e7bb20e8b7133c" class="dfn-panel" data-for="0d3ee326a162c16997e7bb20e8b7133c" id="infopanel-for-0d3ee326a162c16997e7bb20e8b7133c">
   <span id="infopaneltitle-for-0d3ee326a162c16997e7bb20e8b7133c" style="display:none">Info about the 'exist' external reference.</span><a href="https://infra.spec.whatwg.org/#map-exists">https://infra.spec.whatwg.org/#map-exists</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-exists">13.4. Modification to request constructor steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fd74d8159933c4a74d0b23390bed43e3" class="dfn-panel" data-for="fd74d8159933c4a74d0b23390bed43e3" id="infopanel-for-fd74d8159933c4a74d0b23390bed43e3">
   <span id="infopaneltitle-for-fd74d8159933c4a74d0b23390bed43e3" style="display:none">Info about the 'implementation-defined' external reference.</span><a href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined">5. document ID</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fafd38d2108e357bcc9a6fd7f3cd04a7" class="dfn-panel" data-for="fafd38d2108e357bcc9a6fd7f3cd04a7" id="infopanel-for-fafd38d2108e357bcc9a6fd7f3cd04a7">
   <span id="infopaneltitle-for-fafd38d2108e357bcc9a6fd7f3cd04a7" style="display:none">Info about the 'list' external reference.</span><a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">2. Terminology and types</a>
    <li><a href="#ref-for-list①">3. User agent associated state</a>
    <li><a href="#ref-for-list②">9. Periodically calculate user topics</a> <a href="#ref-for-list③">(2)</a>
    <li><a href="#ref-for-list④">10. Epochs for caller</a> <a href="#ref-for-list⑤">(2)</a>
    <li><a href="#ref-for-list⑥">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bed8381510f5967f5d37a33de776e857" class="dfn-panel" data-for="bed8381510f5967f5d37a33de776e857" id="infopanel-for-bed8381510f5967f5d37a33de776e857">
   <span id="infopaneltitle-for-bed8381510f5967f5d37a33de776e857" style="display:none">Info about the 'size' external reference.</span><a href="https://infra.spec.whatwg.org/#list-size">https://infra.spec.whatwg.org/#list-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-size">9. Periodically calculate user topics</a>
    <li><a href="#ref-for-list-size①">10. Epochs for caller</a>
    <li><a href="#ref-for-list-size②">11. Topics for caller</a>
    <li><a href="#ref-for-list-size③">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-52bdfc59f72538efe80e2a86647ac489" class="dfn-panel" data-for="52bdfc59f72538efe80e2a86647ac489" id="infopanel-for-52bdfc59f72538efe80e2a86647ac489">
   <span id="infopaneltitle-for-52bdfc59f72538efe80e2a86647ac489" style="display:none">Info about the 'user agent' external reference.</span><a href="https://infra.spec.whatwg.org/#user-agent">https://infra.spec.whatwg.org/#user-agent</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent">3. User agent associated state</a> <a href="#ref-for-user-agent①">(2)</a> <a href="#ref-for-user-agent②">(3)</a> <a href="#ref-for-user-agent③">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-23e803a7c7cace37e75c5045c4c7fff3" class="dfn-panel" data-for="23e803a7c7cace37e75c5045c4c7fff3" id="infopanel-for-23e803a7c7cace37e75c5045c4c7fff3">
   <span id="infopaneltitle-for-23e803a7c7cace37e75c5045c4c7fff3" style="display:none">Info about the 'default allowlist' external reference.</span><a href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist">https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-policy-controlled-feature-default-allowlist">14. Permissions policy integration</a> <a href="#ref-for-policy-controlled-feature-default-allowlist①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cbc4165961071efad91900c4c7b2fe8b" class="dfn-panel" data-for="cbc4165961071efad91900c4c7b2fe8b" id="infopanel-for-cbc4165961071efad91900c4c7b2fe8b">
   <span id="infopaneltitle-for-cbc4165961071efad91900c4c7b2fe8b" style="display:none">Info about the 'policy-controlled feature' external reference.</span><a href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature">https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-policy-controlled-feature">14. Permissions policy integration</a> <a href="#ref-for-policy-controlled-feature①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-7681ab11c75a55e6b34d4abc7604c144" class="dfn-panel" data-for="7681ab11c75a55e6b34d4abc7604c144" id="infopanel-for-7681ab11c75a55e6b34d4abc7604c144">
   <span id="infopaneltitle-for-7681ab11c75a55e6b34d4abc7604c144" style="display:none">Info about the 'potentially trustworthy origin' external reference.</span><a href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin">https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-potentially-trustworthy-origin">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-2dbfce8d0d3a13b704a69841766343a3" class="dfn-panel" data-for="2dbfce8d0d3a13b704a69841766343a3" id="infopanel-for-2dbfce8d0d3a13b704a69841766343a3">
   <span id="infopaneltitle-for-2dbfce8d0d3a13b704a69841766343a3" style="display:none">Info about the 'domain' external reference.</span><a href="https://url.spec.whatwg.org/#concept-domain">https://url.spec.whatwg.org/#concept-domain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-domain">2. Terminology and types</a>
    <li><a href="#ref-for-concept-domain①">6. Determine topics calculation input data</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8135e1bba65282312a7812610e7057a1" class="dfn-panel" data-for="8135e1bba65282312a7812610e7057a1" id="infopanel-for-8135e1bba65282312a7812610e7057a1">
   <span id="infopaneltitle-for-8135e1bba65282312a7812610e7057a1" style="display:none">Info about the 'host' external reference.</span><a href="https://url.spec.whatwg.org/#concept-url-host">https://url.spec.whatwg.org/#concept-url-host</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-host">6. Determine topics calculation input data</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-eb0e1698348a5ae30cd3aa882b6dff01" class="dfn-panel" data-for="eb0e1698348a5ae30cd3aa882b6dff01" id="infopanel-for-eb0e1698348a5ae30cd3aa882b6dff01">
   <span id="infopaneltitle-for-eb0e1698348a5ae30cd3aa882b6dff01" style="display:none">Info about the 'origin' external reference.</span><a href="https://url.spec.whatwg.org/#concept-url-origin">https://url.spec.whatwg.org/#concept-url-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url-origin">2. Terminology and types</a> <a href="#ref-for-concept-url-origin①">(2)</a> <a href="#ref-for-concept-url-origin②">(3)</a>
    <li><a href="#ref-for-concept-url-origin③">8. Collect topics caller origin</a>
    <li><a href="#ref-for-concept-url-origin④">13.8. Append or modify a request Sec-Browsing-Topics header</a>
    <li><a href="#ref-for-concept-url-origin⑤">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0ab204fb9cc9a746edaff83c0db0740a" class="dfn-panel" data-for="0ab204fb9cc9a746edaff83c0db0740a" id="infopanel-for-0ab204fb9cc9a746edaff83c0db0740a">
   <span id="infopaneltitle-for-0ab204fb9cc9a746edaff83c0db0740a" style="display:none">Info about the 'DOMException' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-DOMException">https://webidl.spec.whatwg.org/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d0f238a61de9310f1738a214749fab18" class="dfn-panel" data-for="d0f238a61de9310f1738a214749fab18" id="infopanel-for-d0f238a61de9310f1738a214749fab18">
   <span id="infopaneltitle-for-d0f238a61de9310f1738a214749fab18" style="display:none">Info about the 'DOMString' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-DOMString">https://webidl.spec.whatwg.org/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">4. BrowsingTopic dictionary</a> <a href="#ref-for-idl-DOMString①">(2)</a> <a href="#ref-for-idl-DOMString②">(3)</a> <a href="#ref-for-idl-DOMString③">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e667e629f6d6cd7af11a164eb4bb237c" class="dfn-panel" data-for="e667e629f6d6cd7af11a164eb4bb237c" id="infopanel-for-e667e629f6d6cd7af11a164eb4bb237c">
   <span id="infopaneltitle-for-e667e629f6d6cd7af11a164eb4bb237c" style="display:none">Info about the 'EnforceRange' external reference.</span><a href="https://webidl.spec.whatwg.org/#EnforceRange">https://webidl.spec.whatwg.org/#EnforceRange</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-EnforceRange">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-aa43258e2b51dc6ebe6268a36e6fd733" class="dfn-panel" data-for="aa43258e2b51dc6ebe6268a36e6fd733" id="infopanel-for-aa43258e2b51dc6ebe6268a36e6fd733">
   <span id="infopaneltitle-for-aa43258e2b51dc6ebe6268a36e6fd733" style="display:none">Info about the 'NotAllowedError' external reference.</span><a href="https://webidl.spec.whatwg.org/#notallowederror">https://webidl.spec.whatwg.org/#notallowederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notallowederror">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" class="dfn-panel" data-for="93669c631ec1ef8e696b4c083bdbe12c" id="infopanel-for-93669c631ec1ef8e696b4c083bdbe12c">
   <span id="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" style="display:none">Info about the 'Promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cdf224ec60dc3b08449a2fbdf3a90406" class="dfn-panel" data-for="cdf224ec60dc3b08449a2fbdf3a90406" id="infopanel-for-cdf224ec60dc3b08449a2fbdf3a90406">
   <span id="infopaneltitle-for-cdf224ec60dc3b08449a2fbdf3a90406" style="display:none">Info about the 'SecureContext' external reference.</span><a href="https://webidl.spec.whatwg.org/#SecureContext">https://webidl.spec.whatwg.org/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bbe33fc7ac016834e4aaddbfd1b084a1" class="dfn-panel" data-for="bbe33fc7ac016834e4aaddbfd1b084a1" id="infopanel-for-bbe33fc7ac016834e4aaddbfd1b084a1">
   <span id="infopaneltitle-for-bbe33fc7ac016834e4aaddbfd1b084a1" style="display:none">Info about the 'a new promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#a-new-promise">https://webidl.spec.whatwg.org/#a-new-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-new-promise">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f8062b07e25ed0281f5cbfb9a54070b4" class="dfn-panel" data-for="f8062b07e25ed0281f5cbfb9a54070b4" id="infopanel-for-f8062b07e25ed0281f5cbfb9a54070b4">
   <span id="infopaneltitle-for-f8062b07e25ed0281f5cbfb9a54070b4" style="display:none">Info about the 'boolean' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-boolean">https://webidl.spec.whatwg.org/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">12. The JavaScript API</a>
    <li><a href="#ref-for-idl-boolean①">13.2. browsingtopics content attribute for HTMLIframeElement</a>
    <li><a href="#ref-for-idl-boolean②">13.3. browsingTopics attribute in RequestInit</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f7204c0306e7ffcb24c31adf6e629e1d" class="dfn-panel" data-for="f7204c0306e7ffcb24c31adf6e629e1d" id="infopanel-for-f7204c0306e7ffcb24c31adf6e629e1d">
   <span id="infopaneltitle-for-f7204c0306e7ffcb24c31adf6e629e1d" style="display:none">Info about the 'reject' external reference.</span><a href="https://webidl.spec.whatwg.org/#reject">https://webidl.spec.whatwg.org/#reject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reject">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f4f973f92274819781816b033aea1f11" class="dfn-panel" data-for="f4f973f92274819781816b033aea1f11" id="infopanel-for-f4f973f92274819781816b033aea1f11">
   <span id="infopaneltitle-for-f4f973f92274819781816b033aea1f11" style="display:none">Info about the 'resolve' external reference.</span><a href="https://webidl.spec.whatwg.org/#resolve">https://webidl.spec.whatwg.org/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-38ab7db52e46bed36993204c29f67202" class="dfn-panel" data-for="38ab7db52e46bed36993204c29f67202" id="infopanel-for-38ab7db52e46bed36993204c29f67202">
   <span id="infopaneltitle-for-38ab7db52e46bed36993204c29f67202" style="display:none">Info about the 'sequence' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-sequence">https://webidl.spec.whatwg.org/#idl-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-sequence">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-be0933df03cd63338f98de217c4158c7" class="dfn-panel" data-for="be0933df03cd63338f98de217c4158c7" id="infopanel-for-be0933df03cd63338f98de217c4158c7">
   <span id="infopaneltitle-for-be0933df03cd63338f98de217c4158c7" style="display:none">Info about the 'this' external reference.</span><a href="https://webidl.spec.whatwg.org/#this">https://webidl.spec.whatwg.org/#this</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-this">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-db891cb1cc28e2bf626982240ec36b2a" class="dfn-panel" data-for="db891cb1cc28e2bf626982240ec36b2a" id="infopanel-for-db891cb1cc28e2bf626982240ec36b2a">
   <span id="infopaneltitle-for-db891cb1cc28e2bf626982240ec36b2a" style="display:none">Info about the 'unsigned long long' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long">https://webidl.spec.whatwg.org/#idl-unsigned-long-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long-long">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="07886e33695d0e7b473ef18f656ad7ac">Document</span>
     <li><span class="dfn-paneled" id="0a24705db1888449eefd8934eabb5d51">descendant text content</span>
     <li><span class="dfn-paneled" id="9c5cdbb5c3dd225a70ea0af45a02c608">origin</span>
     <li><span class="dfn-paneled" id="2fc74f43c6d7f15a4a2fbfbece346388">url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f82af8baf203f1b0578ed1442dd2d24b">current url</span>
     <li><span class="dfn-paneled" id="fdb6c106dead7169eccfe54e56cec6bd">delete</span>
     <li><span class="dfn-paneled" id="6bab4bd07fdabe23531455ff4eabbda0">fetch(input)</span>
     <li><span class="dfn-paneled" id="6ef0be99a5b17cb515c6816ad5548e89">get</span>
     <li><span class="dfn-paneled" id="5171067c910207c96b5420a19bae87a3">header list</span>
     <li><span class="dfn-paneled" id="4fd8d1762cd9c874700296c854598fda">header list <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="d94cb5e6252c9158478ebbe8a624e99c">header list <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="e094c825ead002ca7d4383f2aba777f9">http fetch</span>
     <li><span class="dfn-paneled" id="491791562dd138987138e7051a96c07c">request</span>
     <li><span class="dfn-paneled" id="62eb8611855ca0d3551225567f68307a">request <small>(for Request)</small></span>
     <li><span class="dfn-paneled" id="12a5f639c62d2f0bd5e5e8ab36848416">response</span>
     <li><span class="dfn-paneled" id="a50d6de302855c18285652c8be59e5b0">set a structured field value</span>
     <li><span class="dfn-paneled" id="6f4775873c70787775f9c70f0f110709">url</span>
     <li><span class="dfn-paneled" id="d72233a2731c7f5b88c9c3da9700b26a">window</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HR-TIME-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0527034ee7070fda15ffa50c34dbbc63">DOMHighResTimeStamp</span>
     <li><span class="dfn-paneled" id="c626b66893b5c29e4adba851077ed0e2">coarsen time</span>
     <li><span class="dfn-paneled" id="9213a3aff5ff1021ab4c2d780aa70cee">duration</span>
     <li><span class="dfn-paneled" id="73fffec128d2fef2b2301baf9dc7fa01">duration from</span>
     <li><span class="dfn-paneled" id="c6a6e18a0bfb0f6727343f416cd90c01">unix epoch</span>
     <li><span class="dfn-paneled" id="5602165fe91a6a9a9ba8f7f873e44aef">unsafe current time</span>
     <li><span class="dfn-paneled" id="9ce1d97c81991af84a4cfb8251a89c4e">wall clock</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="62d5145a686fb21602c40aa7f2dc6dcb">CEReactions</span>
     <li><span class="dfn-paneled" id="75ff12c16ae1a8f6cbf2920128280261">HTMLIFrameElement</span>
     <li><span class="dfn-paneled" id="de11cdc07a64c79878f1c3074e81554a">active document</span>
     <li><span class="dfn-paneled" id="3dc9eee4a6a1d169f561b6d87bd08573">allowed to use</span>
     <li><span class="dfn-paneled" id="04e6c32034490f45e4757ead7871de18">associated document</span>
     <li><span class="dfn-paneled" id="7e4a31202358e399f35eee7b9c479f4f">container</span>
     <li><span class="dfn-paneled" id="56d977f87f79f0de3bb0c5ce53846293">content attributes</span>
     <li><span class="dfn-paneled" id="3b597d41857f5e9275bb5cdecc55e21e">domain</span>
     <li><span class="dfn-paneled" id="d815dc723d8b4fe4b1166e2013ec62b7">environment settings object</span>
     <li><span class="dfn-paneled" id="53ea12fcca4eab4ccddd5da403fd6e4b">global object</span>
     <li><span class="dfn-paneled" id="346f0407b3fbc5b580ccfdf1597d8c07">hmac algorithm</span>
     <li><span class="dfn-paneled" id="baf95ce8d0404079723db392663d355e">iframe</span>
     <li><span class="dfn-paneled" id="3a2763fcaa6bc82693554cf36780c0dd">in parallel</span>
     <li><span class="dfn-paneled" id="c65e32440cdd5af483d6b90189ff0d46">navigable</span>
     <li><span class="dfn-paneled" id="d5ad1e20f67eb03bd0608119efdd55f5">node navigable</span>
     <li><span class="dfn-paneled" id="23307d34220e7159f8e5d8c231db141f">opaque origin</span>
     <li><span class="dfn-paneled" id="61b744463dec02bf7e3bb3e3aacce330">post-prerendering activation steps list</span>
     <li><span class="dfn-paneled" id="dea49566381cb105c181f672af8cf41c">prerendering navigable</span>
     <li><span class="dfn-paneled" id="a8756513b792b8f203588906035a13bb">queue a global task</span>
     <li><span class="dfn-paneled" id="b49dc0806d8dbf1a04db8e3ade97d3f3">reflect</span>
     <li><span class="dfn-paneled" id="2233058c8f0998915af8393ee2abbc1d">relevant global object</span>
     <li><span class="dfn-paneled" id="613400696de3e8f8a5001430db03abe8">secure context</span>
     <li><span class="dfn-paneled" id="bc7ee08574febf5b8b0e46ae2c167b82">top-level traversable</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fcfc8b0ed220faa237969aed00e2586d">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="53c2c70bc752d6cf2a1f7deddc029549">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="6e2a0a09507290bb1cc50a58f5bbde89">code unit less than</span>
     <li><span class="dfn-paneled" id="7605aa4703a0a6921736ddd5321cfc07">concatenate</span>
     <li><span class="dfn-paneled" id="eb75379b05abc264a531a791358e1eba">contain</span>
     <li><span class="dfn-paneled" id="0d3ee326a162c16997e7bb20e8b7133c">exist</span>
     <li><span class="dfn-paneled" id="fd74d8159933c4a74d0b23390bed43e3">implementation-defined</span>
     <li><span class="dfn-paneled" id="fafd38d2108e357bcc9a6fd7f3cd04a7">list</span>
     <li><span class="dfn-paneled" id="bed8381510f5967f5d37a33de776e857">size</span>
     <li><span class="dfn-paneled" id="52bdfc59f72538efe80e2a86647ac489">user agent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PERMISSIONS-POLICY-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="23e803a7c7cace37e75c5045c4c7fff3">default allowlist</span>
     <li><span class="dfn-paneled" id="cbc4165961071efad91900c4c7b2fe8b">policy-controlled feature</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7681ab11c75a55e6b34d4abc7604c144">potentially trustworthy origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2dbfce8d0d3a13b704a69841766343a3">domain</span>
     <li><span class="dfn-paneled" id="8135e1bba65282312a7812610e7057a1">host</span>
     <li><span class="dfn-paneled" id="eb0e1698348a5ae30cd3aa882b6dff01">origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0ab204fb9cc9a746edaff83c0db0740a">DOMException</span>
     <li><span class="dfn-paneled" id="d0f238a61de9310f1738a214749fab18">DOMString</span>
     <li><span class="dfn-paneled" id="e667e629f6d6cd7af11a164eb4bb237c">EnforceRange</span>
     <li><span class="dfn-paneled" id="aa43258e2b51dc6ebe6268a36e6fd733">NotAllowedError</span>
     <li><span class="dfn-paneled" id="93669c631ec1ef8e696b4c083bdbe12c">Promise</span>
     <li><span class="dfn-paneled" id="cdf224ec60dc3b08449a2fbdf3a90406">SecureContext</span>
     <li><span class="dfn-paneled" id="bbe33fc7ac016834e4aaddbfd1b084a1">a new promise</span>
     <li><span class="dfn-paneled" id="f8062b07e25ed0281f5cbfb9a54070b4">boolean</span>
     <li><span class="dfn-paneled" id="f7204c0306e7ffcb24c31adf6e629e1d">reject</span>
     <li><span class="dfn-paneled" id="f4f973f92274819781816b033aea1f11">resolve</span>
     <li><span class="dfn-paneled" id="38ab7db52e46bed36993204c29f67202">sequence</span>
     <li><span class="dfn-paneled" id="be0933df03cd63338f98de217c4158c7">this</span>
     <li><span class="dfn-paneled" id="db891cb1cc28e2bf626982240ec36b2a">unsigned long long</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-hr-time-3">[HR-TIME-3]
   <dd>Yoav Weiss. <a href="https://w3c.github.io/hr-time/"><cite>High Resolution Time</cite></a>. URL: <a href="https://w3c.github.io/hr-time/">https://w3c.github.io/hr-time/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-permissions-policy-1">[PERMISSIONS-POLICY-1]
   <dd>Ian Clelland. <a href="https://w3c.github.io/webappsec-permissions-policy/"><cite>Permissions Policy</cite></a>. URL: <a href="https://w3c.github.io/webappsec-permissions-policy/">https://w3c.github.io/webappsec-permissions-policy/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>dictionary</c-> <a href="#dictdef-browsingtopic"><code><c- g>BrowsingTopic</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-type="unsigned long long " href="#dom-browsingtopic-topic"><code><c- g>topic</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-browsingtopic-version"><code><c- g>version</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-browsingtopic-configversion"><code><c- g>configVersion</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-browsingtopic-modelversion"><code><c- g>modelVersion</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-browsingtopic-taxonomyversion"><code><c- g>taxonomyVersion</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-browsingtopicsoptions"><code><c- g>BrowsingTopicsOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-browsingtopicsoptions-skipobservation"><code><c- g>skipObservation</c-></code></a> = <c- b>false</c->;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document"><c- g>Document</c-></a> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-browsingtopic"><c- n>BrowsingTopic</c-></a>>> <a class="idl-code" data-link-type="method" href="#dom-document-browsingtopics"><c- g>browsingTopics</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-browsingtopicsoptions"><c- n>BrowsingTopicsOptions</c-></a> <a href="#dom-document-browsingtopics-options-options"><code><c- g>options</c-></code></a> = {});
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#htmliframeelement"><c- g>HTMLIFrameElement</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions"><c- g>CEReactions</c-></a>] <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-type="boolean" href="#dom-htmliframeelement-browsingtopics"><c- g>browsingTopics</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-requestinit"><code><c- g>RequestInit</c-></code></a> {
  // existing attributes ...

  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean " href="#dom-requestinit-browsingtopics"><code><c- g>browsingTopics</c-></code></a>;
};

</pre>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-taxonomy" class="dfn-panel" data-for="browsing-topics-types-taxonomy" id="infopanel-for-browsing-topics-types-taxonomy">
   <span id="infopaneltitle-for-browsing-topics-types-taxonomy" style="display:none">Info about the 'taxonomy' definition.</span><b><a href="#browsing-topics-types-taxonomy">#browsing-topics-types-taxonomy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-taxonomy">2. Terminology and types</a>
    <li><a href="#ref-for-browsing-topics-types-taxonomy①">3. User agent associated state</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-topic-ids" class="dfn-panel" data-for="browsing-topics-types-topic-ids" id="infopanel-for-browsing-topics-types-topic-ids">
   <span id="infopaneltitle-for-browsing-topics-types-topic-ids" style="display:none">Info about the 'topic ids' definition.</span><b><a href="#browsing-topics-types-topic-ids">#browsing-topics-types-topic-ids</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-topic-ids">2. Terminology and types</a> <a href="#ref-for-browsing-topics-types-topic-ids①">(2)</a> <a href="#ref-for-browsing-topics-types-topic-ids②">(3)</a> <a href="#ref-for-browsing-topics-types-topic-ids③">(4)</a> <a href="#ref-for-browsing-topics-types-topic-ids④">(5)</a> <a href="#ref-for-browsing-topics-types-topic-ids⑤">(6)</a> <a href="#ref-for-browsing-topics-types-topic-ids⑥">(7)</a>
    <li><a href="#ref-for-browsing-topics-types-topic-ids⑦">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-taxonomy-version" class="dfn-panel" data-for="browsing-topics-types-taxonomy-version" id="infopanel-for-browsing-topics-types-taxonomy-version">
   <span id="infopaneltitle-for-browsing-topics-types-taxonomy-version" style="display:none">Info about the 'taxonomy version' definition.</span><b><a href="#browsing-topics-types-taxonomy-version">#browsing-topics-types-taxonomy-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-taxonomy-version">2. Terminology and types</a>
    <li><a href="#ref-for-browsing-topics-types-taxonomy-version①">3. User agent associated state</a>
    <li><a href="#ref-for-browsing-topics-types-taxonomy-version②">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-get-descendant-topics" class="dfn-panel" data-for="get-descendant-topics" id="infopanel-for-get-descendant-topics">
   <span id="infopaneltitle-for-get-descendant-topics" style="display:none">Info about the 'get descendant topics' definition.</span><b><a href="#get-descendant-topics">#get-descendant-topics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-get-descendant-topics">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-model-version" class="dfn-panel" data-for="browsing-topics-types-model-version" id="infopanel-for-browsing-topics-types-model-version">
   <span id="infopaneltitle-for-browsing-topics-types-model-version" style="display:none">Info about the 'model version' definition.</span><b><a href="#browsing-topics-types-model-version">#browsing-topics-types-model-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-model-version">2. Terminology and types</a>
    <li><a href="#ref-for-browsing-topics-types-model-version①">3. User agent associated state</a>
    <li><a href="#ref-for-browsing-topics-types-model-version②">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-model" class="dfn-panel" data-for="browsing-topics-types-model" id="infopanel-for-browsing-topics-types-model">
   <span id="infopaneltitle-for-browsing-topics-types-model" style="display:none">Info about the 'model' definition.</span><b><a href="#browsing-topics-types-model">#browsing-topics-types-model</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-model">3. User agent associated state</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-classify" class="dfn-panel" data-for="classify" id="infopanel-for-classify">
   <span id="infopaneltitle-for-classify" style="display:none">Info about the 'classify' definition.</span><b><a href="#classify">#classify</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-classify">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-configuration-version" class="dfn-panel" data-for="browsing-topics-types-configuration-version" id="infopanel-for-browsing-topics-types-configuration-version">
   <span id="infopaneltitle-for-browsing-topics-types-configuration-version" style="display:none">Info about the 'configuration version' definition.</span><b><a href="#browsing-topics-types-configuration-version">#browsing-topics-types-configuration-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-configuration-version">2. Terminology and types</a>
    <li><a href="#ref-for-browsing-topics-types-configuration-version①">3. User agent associated state</a> <a href="#ref-for-browsing-topics-types-configuration-version②">(2)</a>
    <li><a href="#ref-for-browsing-topics-types-configuration-version③">4. BrowsingTopic dictionary</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-version" class="dfn-panel" data-for="browsing-topics-types-version" id="infopanel-for-browsing-topics-types-version">
   <span id="infopaneltitle-for-browsing-topics-types-version" style="display:none">Info about the 'version' definition.</span><b><a href="#browsing-topics-types-version">#browsing-topics-types-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-version">4. BrowsingTopic dictionary</a>
    <li><a href="#ref-for-browsing-topics-types-version①">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-user-topics-state" class="dfn-panel" data-for="browsing-topics-types-user-topics-state" id="infopanel-for-browsing-topics-types-user-topics-state">
   <span id="infopaneltitle-for-browsing-topics-types-user-topics-state" style="display:none">Info about the 'user topics state' definition.</span><b><a href="#browsing-topics-types-user-topics-state">#browsing-topics-types-user-topics-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-user-topics-state">3. User agent associated state</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-topics-state-epochs" class="dfn-panel" data-for="user-topics-state-epochs" id="infopanel-for-user-topics-state-epochs">
   <span id="infopaneltitle-for-user-topics-state-epochs" style="display:none">Info about the 'epochs' definition.</span><b><a href="#user-topics-state-epochs">#user-topics-state-epochs</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-topics-state-epochs">3. User agent associated state</a>
    <li><a href="#ref-for-user-topics-state-epochs①">9. Periodically calculate user topics</a> <a href="#ref-for-user-topics-state-epochs②">(2)</a> <a href="#ref-for-user-topics-state-epochs③">(3)</a> <a href="#ref-for-user-topics-state-epochs④">(4)</a> <a href="#ref-for-user-topics-state-epochs⑤">(5)</a> <a href="#ref-for-user-topics-state-epochs⑥">(6)</a> <a href="#ref-for-user-topics-state-epochs⑦">(7)</a>
    <li><a href="#ref-for-user-topics-state-epochs⑧">10. Epochs for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-topics-state-hmac-key" class="dfn-panel" data-for="user-topics-state-hmac-key" id="infopanel-for-user-topics-state-hmac-key">
   <span id="infopaneltitle-for-user-topics-state-hmac-key" style="display:none">Info about the 'hmac key' definition.</span><b><a href="#user-topics-state-hmac-key">#user-topics-state-hmac-key</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-topics-state-hmac-key">3. User agent associated state</a>
    <li><a href="#ref-for-user-topics-state-hmac-key①">10. Epochs for caller</a>
    <li><a href="#ref-for-user-topics-state-hmac-key②">11. Topics for caller</a> <a href="#ref-for-user-topics-state-hmac-key③">(2)</a> <a href="#ref-for-user-topics-state-hmac-key④">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-epoch" class="dfn-panel" data-for="browsing-topics-types-epoch" id="infopanel-for-browsing-topics-types-epoch">
   <span id="infopaneltitle-for-browsing-topics-types-epoch" style="display:none">Info about the 'epoch' definition.</span><b><a href="#browsing-topics-types-epoch">#browsing-topics-types-epoch</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-epoch">2. Terminology and types</a>
    <li><a href="#ref-for-browsing-topics-types-epoch①">9. Periodically calculate user topics</a> <a href="#ref-for-browsing-topics-types-epoch②">(2)</a>
    <li><a href="#ref-for-browsing-topics-types-epoch③">10. Epochs for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-epoch-taxonomy" class="dfn-panel" data-for="epoch-taxonomy" id="infopanel-for-epoch-taxonomy">
   <span id="infopaneltitle-for-epoch-taxonomy" style="display:none">Info about the 'taxonomy' definition.</span><b><a href="#epoch-taxonomy">#epoch-taxonomy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-epoch-taxonomy">9. Periodically calculate user topics</a>
    <li><a href="#ref-for-epoch-taxonomy①">11. Topics for caller</a> <a href="#ref-for-epoch-taxonomy②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-epoch-taxonomy-version" class="dfn-panel" data-for="epoch-taxonomy-version" id="infopanel-for-epoch-taxonomy-version">
   <span id="infopaneltitle-for-epoch-taxonomy-version" style="display:none">Info about the 'taxonomy version' definition.</span><b><a href="#epoch-taxonomy-version">#epoch-taxonomy-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-epoch-taxonomy-version">9. Periodically calculate user topics</a>
    <li><a href="#ref-for-epoch-taxonomy-version①">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-epoch-model-version" class="dfn-panel" data-for="epoch-model-version" id="infopanel-for-epoch-model-version">
   <span id="infopaneltitle-for-epoch-model-version" style="display:none">Info about the 'model version' definition.</span><b><a href="#epoch-model-version">#epoch-model-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-epoch-model-version">9. Periodically calculate user topics</a>
    <li><a href="#ref-for-epoch-model-version①">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-epoch-config-version" class="dfn-panel" data-for="epoch-config-version" id="infopanel-for-epoch-config-version">
   <span id="infopaneltitle-for-epoch-config-version" style="display:none">Info about the 'config version' definition.</span><b><a href="#epoch-config-version">#epoch-config-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-epoch-config-version">9. Periodically calculate user topics</a>
    <li><a href="#ref-for-epoch-config-version①">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-epoch-top-5-topics-with-caller-origins" class="dfn-panel" data-for="epoch-top-5-topics-with-caller-origins" id="infopanel-for-epoch-top-5-topics-with-caller-origins">
   <span id="infopaneltitle-for-epoch-top-5-topics-with-caller-origins" style="display:none">Info about the 'top 5 topics with caller origins' definition.</span><b><a href="#epoch-top-5-topics-with-caller-origins">#epoch-top-5-topics-with-caller-origins</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-epoch-top-5-topics-with-caller-origins">9. Periodically calculate user topics</a>
    <li><a href="#ref-for-epoch-top-5-topics-with-caller-origins①">11. Topics for caller</a> <a href="#ref-for-epoch-top-5-topics-with-caller-origins②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-epoch-time" class="dfn-panel" data-for="epoch-time" id="infopanel-for-epoch-time">
   <span id="infopaneltitle-for-epoch-time" style="display:none">Info about the 'time' definition.</span><b><a href="#epoch-time">#epoch-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-epoch-time">9. Periodically calculate user topics</a> <a href="#ref-for-epoch-time①">(2)</a>
    <li><a href="#ref-for-epoch-time②">10. Epochs for caller</a>
    <li><a href="#ref-for-epoch-time③">11. Topics for caller</a> <a href="#ref-for-epoch-time④">(2)</a> <a href="#ref-for-epoch-time⑤">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-topic-with-caller-origins" class="dfn-panel" data-for="browsing-topics-types-topic-with-caller-origins" id="infopanel-for-browsing-topics-types-topic-with-caller-origins">
   <span id="infopaneltitle-for-browsing-topics-types-topic-with-caller-origins" style="display:none">Info about the 'topic with caller origins' definition.</span><b><a href="#browsing-topics-types-topic-with-caller-origins">#browsing-topics-types-topic-with-caller-origins</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-topic-with-caller-origins">2. Terminology and types</a>
    <li><a href="#ref-for-browsing-topics-types-topic-with-caller-origins①">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topic-with-caller-origins-topic-id" class="dfn-panel" data-for="topic-with-caller-origins-topic-id" id="infopanel-for-topic-with-caller-origins-topic-id">
   <span id="infopaneltitle-for-topic-with-caller-origins-topic-id" style="display:none">Info about the 'topic id' definition.</span><b><a href="#topic-with-caller-origins-topic-id">#topic-with-caller-origins-topic-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topic-with-caller-origins-topic-id">9. Periodically calculate user topics</a> <a href="#ref-for-topic-with-caller-origins-topic-id①">(2)</a>
    <li><a href="#ref-for-topic-with-caller-origins-topic-id②">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topic-with-caller-origins-caller-origins" class="dfn-panel" data-for="topic-with-caller-origins-caller-origins" id="infopanel-for-topic-with-caller-origins-caller-origins">
   <span id="infopaneltitle-for-topic-with-caller-origins-caller-origins" style="display:none">Info about the 'caller origins' definition.</span><b><a href="#topic-with-caller-origins-caller-origins">#topic-with-caller-origins-caller-origins</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topic-with-caller-origins-caller-origins">9. Periodically calculate user topics</a> <a href="#ref-for-topic-with-caller-origins-caller-origins①">(2)</a>
    <li><a href="#ref-for-topic-with-caller-origins-caller-origins②">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-topics-history-entry" class="dfn-panel" data-for="browsing-topics-types-topics-history-entry" id="infopanel-for-browsing-topics-types-topics-history-entry">
   <span id="infopaneltitle-for-browsing-topics-types-topics-history-entry" style="display:none">Info about the 'topics history entry' definition.</span><b><a href="#browsing-topics-types-topics-history-entry">#browsing-topics-types-topics-history-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-topics-history-entry">3. User agent associated state</a>
    <li><a href="#ref-for-browsing-topics-types-topics-history-entry①">7. Collect page topics calculation input data</a> <a href="#ref-for-browsing-topics-types-topics-history-entry②">(2)</a>
    <li><a href="#ref-for-browsing-topics-types-topics-history-entry③">8. Collect topics caller origin</a> <a href="#ref-for-browsing-topics-types-topics-history-entry④">(2)</a>
    <li><a href="#ref-for-browsing-topics-types-topics-history-entry⑤">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-history-entry-document-id" class="dfn-panel" data-for="topics-history-entry-document-id" id="infopanel-for-topics-history-entry-document-id">
   <span id="infopaneltitle-for-topics-history-entry-document-id" style="display:none">Info about the 'document id' definition.</span><b><a href="#topics-history-entry-document-id">#topics-history-entry-document-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-history-entry-document-id">7. Collect page topics calculation input data</a> <a href="#ref-for-topics-history-entry-document-id①">(2)</a>
    <li><a href="#ref-for-topics-history-entry-document-id②">8. Collect topics caller origin</a> <a href="#ref-for-topics-history-entry-document-id③">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-history-entry-topics-calculation-input-data" class="dfn-panel" data-for="topics-history-entry-topics-calculation-input-data" id="infopanel-for-topics-history-entry-topics-calculation-input-data">
   <span id="infopaneltitle-for-topics-history-entry-topics-calculation-input-data" style="display:none">Info about the 'topics calculation input data' definition.</span><b><a href="#topics-history-entry-topics-calculation-input-data">#topics-history-entry-topics-calculation-input-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-history-entry-topics-calculation-input-data">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-topics-history-entry-topics-calculation-input-data①">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-history-entry-time" class="dfn-panel" data-for="topics-history-entry-time" id="infopanel-for-topics-history-entry-time">
   <span id="infopaneltitle-for-topics-history-entry-time" style="display:none">Info about the 'time' definition.</span><b><a href="#topics-history-entry-time">#topics-history-entry-time</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-history-entry-time">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-topics-history-entry-time①">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-history-entry-topics-caller-origins" class="dfn-panel" data-for="topics-history-entry-topics-caller-origins" id="infopanel-for-topics-history-entry-topics-caller-origins">
   <span id="infopaneltitle-for-topics-history-entry-topics-caller-origins" style="display:none">Info about the 'topics caller origins' definition.</span><b><a href="#topics-history-entry-topics-caller-origins">#topics-history-entry-topics-caller-origins</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-history-entry-topics-caller-origins">8. Collect topics caller origin</a>
    <li><a href="#ref-for-topics-history-entry-topics-caller-origins①">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-types-topics-caller-context" class="dfn-panel" data-for="browsing-topics-types-topics-caller-context" id="infopanel-for-browsing-topics-types-topics-caller-context">
   <span id="infopaneltitle-for-browsing-topics-types-topics-caller-context" style="display:none">Info about the 'topics caller context' definition.</span><b><a href="#browsing-topics-types-topics-caller-context">#browsing-topics-types-topics-caller-context</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-types-topics-caller-context">10. Epochs for caller</a>
    <li><a href="#ref-for-browsing-topics-types-topics-caller-context①">11. Topics for caller</a>
    <li><a href="#ref-for-browsing-topics-types-topics-caller-context②">12. The JavaScript API</a>
    <li><a href="#ref-for-browsing-topics-types-topics-caller-context③">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-caller-context-caller-origin" class="dfn-panel" data-for="topics-caller-context-caller-origin" id="infopanel-for-topics-caller-context-caller-origin">
   <span id="infopaneltitle-for-topics-caller-context-caller-origin" style="display:none">Info about the 'caller origin' definition.</span><b><a href="#topics-caller-context-caller-origin">#topics-caller-context-caller-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-caller-context-caller-origin">11. Topics for caller</a>
    <li><a href="#ref-for-topics-caller-context-caller-origin①">12. The JavaScript API</a> <a href="#ref-for-topics-caller-context-caller-origin②">(2)</a> <a href="#ref-for-topics-caller-context-caller-origin③">(3)</a>
    <li><a href="#ref-for-topics-caller-context-caller-origin④">13.8. Append or modify a request Sec-Browsing-Topics header</a> <a href="#ref-for-topics-caller-context-caller-origin⑤">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-caller-context-top-level-context-domain" class="dfn-panel" data-for="topics-caller-context-top-level-context-domain" id="infopanel-for-topics-caller-context-top-level-context-domain">
   <span id="infopaneltitle-for-topics-caller-context-top-level-context-domain" style="display:none">Info about the 'top level context domain' definition.</span><b><a href="#topics-caller-context-top-level-context-domain">#topics-caller-context-top-level-context-domain</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-caller-context-top-level-context-domain">10. Epochs for caller</a>
    <li><a href="#ref-for-topics-caller-context-top-level-context-domain①">11. Topics for caller</a> <a href="#ref-for-topics-caller-context-top-level-context-domain②">(2)</a> <a href="#ref-for-topics-caller-context-top-level-context-domain③">(3)</a>
    <li><a href="#ref-for-topics-caller-context-top-level-context-domain④">12. The JavaScript API</a> <a href="#ref-for-topics-caller-context-top-level-context-domain⑤">(2)</a>
    <li><a href="#ref-for-topics-caller-context-top-level-context-domain⑥">13.8. Append or modify a request Sec-Browsing-Topics header</a> <a href="#ref-for-topics-caller-context-top-level-context-domain⑦">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-topics-caller-context-timestamp" class="dfn-panel" data-for="topics-caller-context-timestamp" id="infopanel-for-topics-caller-context-timestamp">
   <span id="infopaneltitle-for-topics-caller-context-timestamp" style="display:none">Info about the 'timestamp' definition.</span><b><a href="#topics-caller-context-timestamp">#topics-caller-context-timestamp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-topics-caller-context-timestamp">10. Epochs for caller</a>
    <li><a href="#ref-for-topics-caller-context-timestamp①">12. The JavaScript API</a>
    <li><a href="#ref-for-topics-caller-context-timestamp②">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-user-topics-state" class="dfn-panel" data-for="user-agent-user-topics-state" id="infopanel-for-user-agent-user-topics-state">
   <span id="infopaneltitle-for-user-agent-user-topics-state" style="display:none">Info about the 'user topics state' definition.</span><b><a href="#user-agent-user-topics-state">#user-agent-user-topics-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-user-topics-state">3. User agent associated state</a>
    <li><a href="#ref-for-user-agent-user-topics-state①">9. Periodically calculate user topics</a> <a href="#ref-for-user-agent-user-topics-state②">(2)</a> <a href="#ref-for-user-agent-user-topics-state③">(3)</a> <a href="#ref-for-user-agent-user-topics-state④">(4)</a> <a href="#ref-for-user-agent-user-topics-state⑤">(5)</a> <a href="#ref-for-user-agent-user-topics-state⑥">(6)</a> <a href="#ref-for-user-agent-user-topics-state⑦">(7)</a>
    <li><a href="#ref-for-user-agent-user-topics-state⑧">10. Epochs for caller</a> <a href="#ref-for-user-agent-user-topics-state⑨">(2)</a>
    <li><a href="#ref-for-user-agent-user-topics-state①⓪">11. Topics for caller</a> <a href="#ref-for-user-agent-user-topics-state①①">(2)</a> <a href="#ref-for-user-agent-user-topics-state①②">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-topics-history-storage" class="dfn-panel" data-for="user-agent-topics-history-storage" id="infopanel-for-user-agent-topics-history-storage">
   <span id="infopaneltitle-for-user-agent-topics-history-storage" style="display:none">Info about the 'topics history storage' definition.</span><b><a href="#user-agent-topics-history-storage">#user-agent-topics-history-storage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-topics-history-storage">3. User agent associated state</a>
    <li><a href="#ref-for-user-agent-topics-history-storage①">7. Collect page topics calculation input data</a> <a href="#ref-for-user-agent-topics-history-storage②">(2)</a>
    <li><a href="#ref-for-user-agent-topics-history-storage③">8. Collect topics caller origin</a> <a href="#ref-for-user-agent-topics-history-storage④">(2)</a>
    <li><a href="#ref-for-user-agent-topics-history-storage⑤">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-taxonomy" class="dfn-panel" data-for="user-agent-taxonomy" id="infopanel-for-user-agent-taxonomy">
   <span id="infopaneltitle-for-user-agent-taxonomy" style="display:none">Info about the 'taxonomy' definition.</span><b><a href="#user-agent-taxonomy">#user-agent-taxonomy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-taxonomy">3. User agent associated state</a>
    <li><a href="#ref-for-user-agent-taxonomy①">9. Periodically calculate user topics</a> <a href="#ref-for-user-agent-taxonomy②">(2)</a> <a href="#ref-for-user-agent-taxonomy③">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-taxonomy-version" class="dfn-panel" data-for="user-agent-taxonomy-version" id="infopanel-for-user-agent-taxonomy-version">
   <span id="infopaneltitle-for-user-agent-taxonomy-version" style="display:none">Info about the 'taxonomy version' definition.</span><b><a href="#user-agent-taxonomy-version">#user-agent-taxonomy-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-taxonomy-version">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-model" class="dfn-panel" data-for="user-agent-model" id="infopanel-for-user-agent-model">
   <span id="infopaneltitle-for-user-agent-model" style="display:none">Info about the 'model' definition.</span><b><a href="#user-agent-model">#user-agent-model</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-model">3. User agent associated state</a>
    <li><a href="#ref-for-user-agent-model①">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-model-version" class="dfn-panel" data-for="user-agent-model-version" id="infopanel-for-user-agent-model-version">
   <span id="infopaneltitle-for-user-agent-model-version" style="display:none">Info about the 'model version' definition.</span><b><a href="#user-agent-model-version">#user-agent-model-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-model-version">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-user-agent-configuration-version" class="dfn-panel" data-for="user-agent-configuration-version" id="infopanel-for-user-agent-configuration-version">
   <span id="infopaneltitle-for-user-agent-configuration-version" style="display:none">Info about the 'configuration version' definition.</span><b><a href="#user-agent-configuration-version">#user-agent-configuration-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-agent-configuration-version">3. User agent associated state</a>
    <li><a href="#ref-for-user-agent-configuration-version①">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-browsingtopic" class="dfn-panel" data-for="dictdef-browsingtopic" id="infopanel-for-dictdef-browsingtopic">
   <span id="infopaneltitle-for-dictdef-browsingtopic" style="display:none">Info about the 'BrowsingTopic' definition.</span><b><a href="#dictdef-browsingtopic">#dictdef-browsingtopic</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-browsingtopic">4. BrowsingTopic dictionary</a> <a href="#ref-for-dictdef-browsingtopic①">(2)</a> <a href="#ref-for-dictdef-browsingtopic②">(3)</a> <a href="#ref-for-dictdef-browsingtopic③">(4)</a>
    <li><a href="#ref-for-dictdef-browsingtopic④">11. Topics for caller</a> <a href="#ref-for-dictdef-browsingtopic⑤">(2)</a> <a href="#ref-for-dictdef-browsingtopic⑥">(3)</a> <a href="#ref-for-dictdef-browsingtopic⑦">(4)</a>
    <li><a href="#ref-for-dictdef-browsingtopic⑧">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-browsingtopic-topic" class="dfn-panel" data-for="dom-browsingtopic-topic" id="infopanel-for-dom-browsingtopic-topic">
   <span id="infopaneltitle-for-dom-browsingtopic-topic" style="display:none">Info about the 'topic' definition.</span><b><a href="#dom-browsingtopic-topic">#dom-browsingtopic-topic</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-browsingtopic-topic">4. BrowsingTopic dictionary</a> <a href="#ref-for-dom-browsingtopic-topic①">(2)</a>
    <li><a href="#ref-for-dom-browsingtopic-topic②">11. Topics for caller</a> <a href="#ref-for-dom-browsingtopic-topic③">(2)</a> <a href="#ref-for-dom-browsingtopic-topic④">(3)</a>
    <li><a href="#ref-for-dom-browsingtopic-topic⑤">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-browsingtopic-version" class="dfn-panel" data-for="dom-browsingtopic-version" id="infopanel-for-dom-browsingtopic-version">
   <span id="infopaneltitle-for-dom-browsingtopic-version" style="display:none">Info about the 'version' definition.</span><b><a href="#dom-browsingtopic-version">#dom-browsingtopic-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-browsingtopic-version">4. BrowsingTopic dictionary</a> <a href="#ref-for-dom-browsingtopic-version①">(2)</a>
    <li><a href="#ref-for-dom-browsingtopic-version②">11. Topics for caller</a>
    <li><a href="#ref-for-dom-browsingtopic-version③">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-browsingtopic-configversion" class="dfn-panel" data-for="dom-browsingtopic-configversion" id="infopanel-for-dom-browsingtopic-configversion">
   <span id="infopaneltitle-for-dom-browsingtopic-configversion" style="display:none">Info about the 'configVersion' definition.</span><b><a href="#dom-browsingtopic-configversion">#dom-browsingtopic-configversion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-browsingtopic-configversion">11. Topics for caller</a> <a href="#ref-for-dom-browsingtopic-configversion①">(2)</a>
    <li><a href="#ref-for-dom-browsingtopic-configversion②">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-browsingtopic-modelversion" class="dfn-panel" data-for="dom-browsingtopic-modelversion" id="infopanel-for-dom-browsingtopic-modelversion">
   <span id="infopaneltitle-for-dom-browsingtopic-modelversion" style="display:none">Info about the 'modelVersion' definition.</span><b><a href="#dom-browsingtopic-modelversion">#dom-browsingtopic-modelversion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-browsingtopic-modelversion">11. Topics for caller</a> <a href="#ref-for-dom-browsingtopic-modelversion①">(2)</a>
    <li><a href="#ref-for-dom-browsingtopic-modelversion②">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-browsingtopic-taxonomyversion" class="dfn-panel" data-for="dom-browsingtopic-taxonomyversion" id="infopanel-for-dom-browsingtopic-taxonomyversion">
   <span id="infopaneltitle-for-dom-browsingtopic-taxonomyversion" style="display:none">Info about the 'taxonomyVersion' definition.</span><b><a href="#dom-browsingtopic-taxonomyversion">#dom-browsingtopic-taxonomyversion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-browsingtopic-taxonomyversion">11. Topics for caller</a> <a href="#ref-for-dom-browsingtopic-taxonomyversion①">(2)</a>
    <li><a href="#ref-for-dom-browsingtopic-taxonomyversion②">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-dictionary-less-than-comparator" class="dfn-panel" data-for="browsing-topics-dictionary-less-than-comparator" id="infopanel-for-browsing-topics-dictionary-less-than-comparator">
   <span id="infopaneltitle-for-browsing-topics-dictionary-less-than-comparator" style="display:none">Info about the 'code unit less than' definition.</span><b><a href="#browsing-topics-dictionary-less-than-comparator">#browsing-topics-dictionary-less-than-comparator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-dictionary-less-than-comparator">11. Topics for caller</a> <a href="#ref-for-browsing-topics-dictionary-less-than-comparator">(2)</a> <a href="#ref-for-browsing-topics-dictionary-less-than-comparator①">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-document-id-header-document-id" class="dfn-panel" data-for="document-id-header-document-id" id="infopanel-for-document-id-header-document-id">
   <span id="infopaneltitle-for-document-id-header-document-id" style="display:none">Info about the 'document id' definition.</span><b><a href="#document-id-header-document-id">#document-id-header-document-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-id-header-document-id">7. Collect page topics calculation input data</a>
    <li><a href="#ref-for-document-id-header-document-id①">8. Collect topics caller origin</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-determine-topics-calculation-input-data-header-topics-calculation-input-data" class="dfn-panel" data-for="determine-topics-calculation-input-data-header-topics-calculation-input-data" id="infopanel-for-determine-topics-calculation-input-data-header-topics-calculation-input-data">
   <span id="infopaneltitle-for-determine-topics-calculation-input-data-header-topics-calculation-input-data" style="display:none">Info about the 'topics calculation input data' definition.</span><b><a href="#determine-topics-calculation-input-data-header-topics-calculation-input-data">#determine-topics-calculation-input-data-header-topics-calculation-input-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determine-topics-calculation-input-data-header-topics-calculation-input-data">6. Determine topics calculation input data</a> <a href="#ref-for-determine-topics-calculation-input-data-header-topics-calculation-input-data①">(2)</a>
    <li><a href="#ref-for-determine-topics-calculation-input-data-header-topics-calculation-input-data②">7. Collect page topics calculation input data</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-collect-page-topics-calculation-input-data" class="dfn-panel" data-for="collect-page-topics-calculation-input-data" id="infopanel-for-collect-page-topics-calculation-input-data">
   <span id="infopaneltitle-for-collect-page-topics-calculation-input-data" style="display:none">Info about the 'collect page topics calculation input data' definition.</span><b><a href="#collect-page-topics-calculation-input-data">#collect-page-topics-calculation-input-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-collect-page-topics-calculation-input-data">12. The JavaScript API</a>
    <li><a href="#ref-for-collect-page-topics-calculation-input-data①">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-collect-topics-caller-origin" class="dfn-panel" data-for="collect-topics-caller-origin" id="infopanel-for-collect-topics-caller-origin">
   <span id="infopaneltitle-for-collect-topics-caller-origin" style="display:none">Info about the 'collect topics caller origin' definition.</span><b><a href="#collect-topics-caller-origin">#collect-topics-caller-origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-collect-topics-caller-origin">12. The JavaScript API</a>
    <li><a href="#ref-for-collect-topics-caller-origin①">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-schedule-user-topics-calculation" class="dfn-panel" data-for="schedule-user-topics-calculation" id="infopanel-for-schedule-user-topics-calculation">
   <span id="infopaneltitle-for-schedule-user-topics-calculation" style="display:none">Info about the 'schedule user topics calculation' definition.</span><b><a href="#schedule-user-topics-calculation">#schedule-user-topics-calculation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-schedule-user-topics-calculation">9. Periodically calculate user topics</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-calculate-user-topics" class="dfn-panel" data-for="calculate-user-topics" id="infopanel-for-calculate-user-topics">
   <span id="infopaneltitle-for-calculate-user-topics" style="display:none">Info about the 'calculate user topics' definition.</span><b><a href="#calculate-user-topics">#calculate-user-topics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-calculate-user-topics">3. User agent associated state</a>
    <li><a href="#ref-for-calculate-user-topics①">9. Periodically calculate user topics</a> <a href="#ref-for-calculate-user-topics②">(2)</a> <a href="#ref-for-calculate-user-topics③">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-calculate-the-epochs-for-caller" class="dfn-panel" data-for="calculate-the-epochs-for-caller" id="infopanel-for-calculate-the-epochs-for-caller">
   <span id="infopaneltitle-for-calculate-the-epochs-for-caller" style="display:none">Info about the 'calculate the epochs for caller' definition.</span><b><a href="#calculate-the-epochs-for-caller">#calculate-the-epochs-for-caller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-calculate-the-epochs-for-caller">11. Topics for caller</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-calculate-the-topics-for-caller" class="dfn-panel" data-for="calculate-the-topics-for-caller" id="infopanel-for-calculate-the-topics-for-caller">
   <span id="infopaneltitle-for-calculate-the-topics-for-caller" style="display:none">Info about the 'calculate the topics for caller' definition.</span><b><a href="#calculate-the-topics-for-caller">#calculate-the-topics-for-caller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-calculate-the-topics-for-caller">12. The JavaScript API</a>
    <li><a href="#ref-for-calculate-the-topics-for-caller①">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-browsingtopicsoptions" class="dfn-panel" data-for="dictdef-browsingtopicsoptions" id="infopanel-for-dictdef-browsingtopicsoptions">
   <span id="infopaneltitle-for-dictdef-browsingtopicsoptions" style="display:none">Info about the 'BrowsingTopicsOptions' definition.</span><b><a href="#dictdef-browsingtopicsoptions">#dictdef-browsingtopicsoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-browsingtopicsoptions">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-browsingtopicsoptions-skipobservation" class="dfn-panel" data-for="dom-browsingtopicsoptions-skipobservation" id="infopanel-for-dom-browsingtopicsoptions-skipobservation">
   <span id="infopaneltitle-for-dom-browsingtopicsoptions-skipobservation" style="display:none">Info about the 'skipObservation' definition.</span><b><a href="#dom-browsingtopicsoptions-skipobservation">#dom-browsingtopicsoptions-skipobservation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-browsingtopicsoptions-skipobservation">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-document-browsingtopics" class="dfn-panel" data-for="dom-document-browsingtopics" id="infopanel-for-dom-document-browsingtopics">
   <span id="infopaneltitle-for-dom-document-browsingtopics" style="display:none">Info about the 'browsingTopics(options)' definition.</span><b><a href="#dom-document-browsingtopics">#dom-document-browsingtopics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-document-browsingtopics">1. Introduction</a>
    <li><a href="#ref-for-dom-document-browsingtopics①">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-task-source" class="dfn-panel" data-for="browsing-topics-task-source" id="infopanel-for-browsing-topics-task-source">
   <span id="infopaneltitle-for-browsing-topics-task-source" style="display:none">Info about the 'browsing topics task source' definition.</span><b><a href="#browsing-topics-task-source">#browsing-topics-task-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-task-source">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-request-send-browsing-topics-header-boolean" class="dfn-panel" data-for="request-send-browsing-topics-header-boolean" id="infopanel-for-request-send-browsing-topics-header-boolean">
   <span id="infopaneltitle-for-request-send-browsing-topics-header-boolean" style="display:none">Info about the 'send browsing topics header boolean' definition.</span><b><a href="#request-send-browsing-topics-header-boolean">#request-send-browsing-topics-header-boolean</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-request-send-browsing-topics-header-boolean">13.4. Modification to request constructor steps</a>
    <li><a href="#ref-for-request-send-browsing-topics-header-boolean①">13.5. Modification to "create navigation params by fetching" steps</a>
    <li><a href="#ref-for-request-send-browsing-topics-header-boolean②">13.8. Append or modify a request Sec-Browsing-Topics header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-element-attrdef-iframe-browsingtopics" class="dfn-panel" data-for="element-attrdef-iframe-browsingtopics" id="infopanel-for-element-attrdef-iframe-browsingtopics">
   <span id="infopaneltitle-for-element-attrdef-iframe-browsingtopics" style="display:none">Info about the 'browsingtopics' definition.</span><b><a href="#element-attrdef-iframe-browsingtopics">#element-attrdef-iframe-browsingtopics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element-attrdef-iframe-browsingtopics">13.2. browsingtopics content attribute for HTMLIframeElement</a>
    <li><a href="#ref-for-element-attrdef-iframe-browsingtopics①">13.5. Modification to "create navigation params by fetching" steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-htmliframeelement-browsingtopics" class="dfn-panel" data-for="dom-htmliframeelement-browsingtopics" id="infopanel-for-dom-htmliframeelement-browsingtopics">
   <span id="infopaneltitle-for-dom-htmliframeelement-browsingtopics" style="display:none">Info about the 'browsingTopics' definition.</span><b><a href="#dom-htmliframeelement-browsingtopics">#dom-htmliframeelement-browsingtopics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-htmliframeelement-browsingtopics">13.2. browsingtopics content attribute for HTMLIframeElement</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-requestinit-browsingtopics" class="dfn-panel" data-for="dom-requestinit-browsingtopics" id="infopanel-for-dom-requestinit-browsingtopics">
   <span id="infopaneltitle-for-dom-requestinit-browsingtopics" style="display:none">Info about the 'browsingTopics' definition.</span><b><a href="#dom-requestinit-browsingtopics">#dom-requestinit-browsingtopics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-requestinit-browsingtopics">13.4. Modification to request constructor steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-http-headerdef-sec-browsing-topics" class="dfn-panel" data-for="http-headerdef-sec-browsing-topics" id="infopanel-for-http-headerdef-sec-browsing-topics">
   <span id="infopaneltitle-for-http-headerdef-sec-browsing-topics" style="display:none">Info about the 'Sec-Browsing-Topics' definition.</span><b><a href="#http-headerdef-sec-browsing-topics">#http-headerdef-sec-browsing-topics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-http-headerdef-sec-browsing-topics">1. Introduction</a>
    <li><a href="#ref-for-http-headerdef-sec-browsing-topics①">13.8. Append or modify a request Sec-Browsing-Topics header</a> <a href="#ref-for-http-headerdef-sec-browsing-topics②">(2)</a>
    <li><a href="#ref-for-http-headerdef-sec-browsing-topics③">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-append-or-modify-a-request-sec-browsing-topics-header" class="dfn-panel" data-for="append-or-modify-a-request-sec-browsing-topics-header" id="infopanel-for-append-or-modify-a-request-sec-browsing-topics-header">
   <span id="infopaneltitle-for-append-or-modify-a-request-sec-browsing-topics-header" style="display:none">Info about the 'append or modify a request `Sec-Browsing-Topics` header' definition.</span><b><a href="#append-or-modify-a-request-sec-browsing-topics-header">#append-or-modify-a-request-sec-browsing-topics-header</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-append-or-modify-a-request-sec-browsing-topics-header">13.7. Modification to HTTP-network-or-cache fetch algorithm</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-http-headerdef-observe-browsing-topics" class="dfn-panel" data-for="http-headerdef-observe-browsing-topics" id="infopanel-for-http-headerdef-observe-browsing-topics">
   <span id="infopaneltitle-for-http-headerdef-observe-browsing-topics" style="display:none">Info about the 'Observe-Browsing-Topics' definition.</span><b><a href="#http-headerdef-observe-browsing-topics">#http-headerdef-observe-browsing-topics</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-http-headerdef-observe-browsing-topics">13.9. The `Observe-Browsing-Topics` HTTP response header</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-handle-topics-response" class="dfn-panel" data-for="handle-topics-response" id="infopanel-for-handle-topics-response">
   <span id="infopaneltitle-for-handle-topics-response" style="display:none">Info about the 'handle topics response' definition.</span><b><a href="#handle-topics-response">#handle-topics-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handle-topics-response">13.10. Modification to HTTP fetch steps</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-browsing-topics-policy-controlled-feature" class="dfn-panel" data-for="browsing-topics-policy-controlled-feature" id="infopanel-for-browsing-topics-policy-controlled-feature">
   <span id="infopaneltitle-for-browsing-topics-policy-controlled-feature" style="display:none">Info about the 'browsing-topics' definition.</span><b><a href="#browsing-topics-policy-controlled-feature">#browsing-topics-policy-controlled-feature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-topics-policy-controlled-feature">12. The JavaScript API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-interest-cohort-policy-controlled-feature" class="dfn-panel" data-for="interest-cohort-policy-controlled-feature" id="infopanel-for-interest-cohort-policy-controlled-feature">
   <span id="infopaneltitle-for-interest-cohort-policy-controlled-feature" style="display:none">Info about the 'interest-cohort' definition.</span><b><a href="#interest-cohort-policy-controlled-feature">#interest-cohort-policy-controlled-feature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-interest-cohort-policy-controlled-feature">12. The JavaScript API</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */
"use strict";
{
    function queryAll(sel) {
        return [].slice.call(document.querySelectorAll(sel));
    }

    // Add popup behavior to all dfns to show the corresponding dfn-panel.
    var dfns = document.querySelectorAll('.dfn-paneled');
    for (let dfn of dfns) { insertDfnPopupAction(dfn); }

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });

    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn) {
        // Find dfn panel
        const dfnPanel = document.querySelector(`.dfn-panel[data-for='${dfn.id}']`);
        if (dfnPanel) {
            const panelWrapper = document.createElement('span');
            panelWrapper.appendChild(dfnPanel);
            panelWrapper.style.position = "relative";
            panelWrapper.style.height = "0px";
            dfn.insertAdjacentElement("afterend", panelWrapper);
            dfn.setAttribute('role', 'button');
            dfn.setAttribute('aria-expanded', 'false')
            dfn.tabIndex = 0;
            dfn.classList.add('has-dfn-panel');
            dfn.addEventListener('click', (event) => {
                showDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
            });
            dfn.addEventListener('keypress', (event) => {
                const kc = event.keyCode;
                // 32->Space, 13->Enter
                if(kc == 32 || kc == 13) {
                    toggleDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            });

            dfnPanel.addEventListener('click', (event) => {
                pinDfnPanel(dfnPanel);
                event.stopPropagation();
            });

            dfnPanel.addEventListener('keydown', (event) => {
                if(event.keyCode == 27) { // Escape key
                    hideDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            })

        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + dfn.id + "']");
        }
    }
}
</script>
<script>/* script-var-click-highlighting */

    "use strict";
    {
        document.addEventListener("click", e=>{
            if(e.target.nodeName == "VAR") {
                highlightSameAlgoVars(e.target);
            }
        });
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>